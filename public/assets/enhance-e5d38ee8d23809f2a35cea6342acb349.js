/*
 * EnhanceJS version 1.1 - Test-Driven Progressive Enhancement
 * http://enhancejs.googlecode.com/
 * Copyright (c) 2010 Filament Group, Inc, authors.txt
 * Licensed under MIT (license.txt)
*/
!function(t,e,i){function n(){return!!e.cookie}function s(){k(D.testName,"fail"),t.location.reload()}function o(){k(D.testName,"pass"),t.location.reload()}function a(){E(D.testName),t.location.reload()}function r(){S=e.createElement("body"),P.insertBefore(S,P.firstChild),A=S}function l(){P.removeChild(S),A=e.body}function h(){var t=T(D.testName);if(t)"pass"===t?(f(),D.onPass()):(D.onFail(),d()),D.appendToggleLink&&u(function(){c(t)});else{var e=!0;r();for(var i in D.tests)if(e=D.tests[i](),!e){D.alertOnFailure&&alert(i+" failed");break}l(),t=e?"pass":"fail",k(D.testName,t),e?(f(),D.onPass()):(D.onFail(),d()),D.appendToggleLink&&u(function(){c(t)})}}function u(e){if(N)e();else{var i=t.onload;t.onload=function(){i&&i(),e()}}}function c(t){if(D.appendToggleLink&&enhance.cookiesSupported&&t){var i=e.createElement("a");i.href="#",i.className=D.testName+"_toggleResult",i.innerHTML="pass"===t?D.forceFailText:D.forcePassText,i.onclick="pass"===t?enhance.forceFail:enhance.forcePass,e.getElementsByTagName("body")[0].appendChild(i)}}function d(){P.className=P.className.replace(D.testName,"")}function f(){I=!0,D.loadStyles.length&&v(),D.loadScripts.length?b():D.onScriptsLoaded()}function p(e,i){T(L)&&T(B)?(E(L),E(B)):(k(L,e),k(B,i)),t.location.reload()}function m(t){return 2==F.length&&(t==F[0]?t=F[1]:t==F[1]&&(t=F[0])),t}function _(){var t=D.testName+"-incomplete";-1===P.className.indexOf(t)&&(P.className+=" "+t)}function g(t){if(t.constructor===Array){var e=!0;for(var i in t)e&&(e=!!t[i]);return e}return!!t}function v(){for(var t,n=-1;t=D.loadStyles[++n];){var s=e.createElement("link");if(s.type="text/css",s.rel="stylesheet",s.onerror=D.onLoadError,"string"==typeof t)s.href=t,z.appendChild(s);else{t.media&&(t.media=m(t.media),D.media&&D.media[t.media]!==i&&(t.media=D.media[t.media])),t.excludemedia&&(t.excludemedia=m(t.excludemedia));var o=!0;if(t.media&&"print"!==t.media&&"projection"!==t.media&&"speech"!==t.media&&"aural"!==t.media&&"braille"!==t.media&&(o=H(t.media)),o&&t.excludemedia&&(o=!H(t.excludemedia)),o&&t.iecondition&&(o=M(t.iecondition)),o&&t.ifsupported!==i&&(o=g(t.ifsupported),o||t.fallback===i||(t.href=t.fallback,o=!0)),o){for(var a in t)"iecondition"!==a&&"excludemedia"!==a&&"ifsupported"!==a&&"fallback"!==a&&s.setAttribute(a,t[a]);z.appendChild(s)}}}}function b(){D.queueLoading?y():x()}function y(){function t(){if(0===e.length)return!1;var i=e.shift(),n=w(i),s=!1;return n?(n.onload=n.onreadystatechange=function(){s||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(s=!0,t()===!1&&D.onScriptsLoaded(),this.onload=this.onreadystatechange=null)},z.insertBefore(n,z.firstChild),void 0):t()}var e=[].concat(D.loadScripts);t()}function x(){for(var t,e=-1;t=D.loadScripts[++e];){var i=w(t);i&&z.insertBefore(i,z.firstChild)}D.onScriptsLoaded()}function w(t){var n=e.createElement("script");if(n.type="text/javascript",n.onerror=D.onLoadError,"string"==typeof t)return n.src=t,n;t.media&&(t.media=m(t.media),D.media&&D.media[t.media]&&(t.media=D.media[t.media])),t.excludemedia&&(t.excludemedia=m(t.excludemedia));var s=!0;if(t.media&&(s=H(t.media)),s&&t.excludemedia&&(s=!H(t.excludemedia)),s&&t.iecondition&&(s=M(t.iecondition)),s&&t.ifsupported!==i&&(s=g(t.ifsupported),s||t.fallback===i||(t.src=t.fallback,s=!0)),s){for(var o in t)"iecondition"!==o&&"media"!==o&&"excludemedia"!==o&&"ifsupported"!==o&&"fallback"!==o&&n.setAttribute(o,t[o]);return n}return!1}function k(t,i,n){n=n||90;var s=new Date;s.setTime(s.getTime()+1e3*60*60*24*n);var o="; expires="+s.toGMTString();e.cookie=t+"="+i+o+"; path=/"}function T(t){for(var i=t+"=",n=e.cookie.split(";"),s=0;s<n.length;s++){for(var o=n[s];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(i))return o.substring(i.length,o.length)}return null}function E(t){k(t,"",-1)}function C(){null==e.readyState&&e.addEventListener&&(e.addEventListener("DOMContentLoaded",function t(){e.removeEventListener("DOMContentLoaded",t,!1),e.readyState="complete"},!1),e.readyState="loading")}var D,A,S,N,z,L,B,P=e.documentElement,I=!1,F=[];z=e.getElementsByTagName?e.getElementsByTagName("head")[0]||P:P;var H=function(){var t={},n=e.createElement("div");return n.setAttribute("id","ejs-qtest"),function(s){if(t[s]===i){r();var o=e.createElement("style");o.type="text/css",z.appendChild(o);var a="@media "+s+" { #ejs-qtest { position: absolute; width: 10px; } }";o.styleSheet?o.styleSheet.cssText=a:o.appendChild(e.createTextNode(a)),A.appendChild(n);var h=n.offsetWidth;A.removeChild(n),z.removeChild(o),l(),t[s]=10==h}return t[s]}}();t.enhance=function(t){t=t||{},D={};for(var e in enhance.defaultSettings){var n=t[e];D[e]=n!==i?n:enhance.defaultSettings[e]}for(var s in t.addTests)D.tests[s]=t.addTests[s];-1===P.className.indexOf(D.testName)&&(P.className+=" "+D.testName),L=D.testName+"-toggledmediaA",B=D.testName+"-toggledmediaB",F=[T(L),T(B)],setTimeout(function(){I||d()},3e3),h(),C(),u(function(){N=!0})},enhance.query=H,enhance.defaultTests={getById:function(){return!!e.getElementById},getByTagName:function(){return!!e.getElementsByTagName},createEl:function(){return!!e.createElement},boxmodel:function(){var t=e.createElement("div");t.style.cssText="width: 1px; padding: 1px;",A.appendChild(t);var i=t.offsetWidth;return A.removeChild(t),3===i},position:function(){var t=e.createElement("div");t.style.cssText="position: absolute; left: 10px;",A.appendChild(t);var i=t.offsetLeft;return A.removeChild(t),10===i},floatClear:function(){var t=!1,i=e.createElement("div"),n='style="width: 5px; height: 5px; float: left;"';i.innerHTML="<div "+n+"></div><div "+n+"></div>",A.appendChild(i);var s=i.childNodes,o=s[0].offsetTop,a=s[1],r=a.offsetTop;return o===r&&(a.style.clear="left",r=a.offsetTop,o!==r&&(t=!0)),A.removeChild(i),t},heightOverflow:function(){var t=e.createElement("div");t.innerHTML='<div style="height: 10px;"></div>',t.style.cssText="overflow: hidden; height: 0;",A.appendChild(t);var i=t.offsetHeight;return A.removeChild(t),0===i},ajax:function(){for(var t,e=!1,i=-1,n=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];t=n[++i];){try{e=t()}catch(s){continue}break}return!!e},resize:function(){return 0!=t.onresize},print:function(){return!!t.print}},enhance.defaultSettings={testName:"enhanced",loadScripts:[],loadStyles:[],queueLoading:!0,appendToggleLink:!0,forcePassText:"View high-bandwidth version",forceFailText:"View low-bandwidth version",tests:enhance.defaultTests,media:{"-ejs-desktop":enhance.query("screen and (max-device-width: 1024px)")?"not screen and (max-device-width: 1024px)":"screen","-ejs-handheld":"screen and (max-device-width: 1024px)"},addTests:{},alertOnFailure:!1,onPass:function(){},onFail:function(){},onLoadError:_,onScriptsLoaded:function(){}},enhance.cookiesSupported=n(),enhance.cookiesSupported&&(enhance.forceFail=s),enhance.cookiesSupported&&(enhance.forcePass=o),enhance.cookiesSupported&&(enhance.reTest=a),enhance.toggleMedia=p;var M=function(){return function(t){return!1}}()}(window,document);