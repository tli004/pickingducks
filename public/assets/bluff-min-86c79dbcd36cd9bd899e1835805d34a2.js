Bluff={VERSION:"0.3.6",array:function(t){if(void 0===t.length)return[t];for(var e=[],i=t.length;i--;)e[i]=t[i];return e},array_new:function(t,e){for(var i=[];t--;)i.push(e);return i},each:function(t,e,i){for(var n=0,s=t.length;s>n;n++)e.call(i||null,t[n],n)},index:function(t,e){for(var i=0,n=t.length;n>i;i++)if(t[i]===e)return i;return-1},keys:function(t){var e,i=[];for(e in t)i.push(e);return i},map:function(t,e,i){var n=[];return this.each(t,function(t){n.push(e.call(i||null,t))}),n},reverse_each:function(t,e,i){for(var n=t.length;n--;)e.call(i||null,t[n],n)},sum:function(t){for(var e=0,i=t.length;i--;)e+=t[i];return e},Mini:{}},Bluff.Base=new JS.Class({extend:{DEBUG:!1,DATA_LABEL_INDEX:0,DATA_VALUES_INDEX:1,DATA_COLOR_INDEX:2,LEGEND_MARGIN:20,TITLE_MARGIN:20,LABEL_MARGIN:10,DEFAULT_MARGIN:20,DEFAULT_TARGET_WIDTH:800,THOUSAND_SEPARATOR:","},top_margin:null,bottom_margin:null,right_margin:null,left_margin:null,title_margin:null,legend_margin:null,labels:null,center_labels_over_point:null,has_left_labels:null,x_axis_label:null,y_axis_label:null,y_axis_increment:null,colors:null,title:null,font:null,font_color:null,hide_line_markers:null,hide_legend:null,hide_title:null,hide_line_numbers:null,no_data_message:null,title_font_size:null,legend_font_size:null,marker_font_size:null,marker_color:null,marker_count:null,minimum_value:null,maximum_value:null,sort:null,additional_line_values:null,stacked:null,legend_box_size:null,tooltips:!1,initialize:function(t,e){this._0=new Bluff.Renderer(t),e=e||this.klass.DEFAULT_TARGET_WIDTH;var i;"number"!=typeof e?(i=e.split("x"),this._j=parseFloat(i[0]),this._t=parseFloat(i[1])):(this._j=parseFloat(e),this._t=.75*this._j),this.initialize_ivars(),this._1j(),this.theme_keynote(),this._10={}},initialize_ivars:function(){this._b=800,this._L=800*(this._t/this._j),this._5=0,this.marker_count=null,this.maximum_value=this.minimum_value=null,this._c=!1,this._1=[],this.labels={},this._u={},this.sort=!0,this.title=null,this._a=this._j/this._b,this.marker_font_size=21,this.legend_font_size=20,this.title_font_size=36,this.top_margin=this.bottom_margin=this.left_margin=this.right_margin=this.klass.DEFAULT_MARGIN,this.legend_margin=this.klass.LEGEND_MARGIN,this.title_margin=this.klass.TITLE_MARGIN,this.legend_box_size=20,this.no_data_message="No Data",this.hide_line_markers=this.hide_legend=this.hide_title=this.hide_line_numbers=!1,this.center_labels_over_point=!0,this.has_left_labels=!1,this.additional_line_values=[],this._1C=[],this._k={},this.x_axis_label=this.y_axis_label=null,this.y_axis_increment=null,this.stacked=null,this._9=null},set_margins:function(t){this.top_margin=this.left_margin=this.right_margin=this.bottom_margin=t},set_font:function(t){this.font=t,this._0.font=this.font},add_color:function(t){this.colors.push(t)},replace_colors:function(t){this.colors=t||[],this._w=0},set_theme:function(t){this._1j(),this._k={colors:["black","white"],additional_line_colors:[],marker_color:"white",font_color:"black",background_colors:null,background_image:null};for(var e in t)this._k[e]=t[e];this.colors=this._k.colors,this.marker_color=this._k.marker_color,this.font_color=this._k.font_color||this.marker_color,this._1C=this._k.additional_line_colors,this._M()},set_background:function(t){t.colors&&(this._k.background_colors=t.colors),t.image&&(this._k.background_image=t.image),this._M()},theme_keynote:function(){this._11="#6886B4",this._12="#FDD84E",this._v="#72AE6E",this._D="#D1695E",this._13="#8A6EAF",this._E="#EFAA43",this._F="white",this.colors=[this._12,this._11,this._v,this._D,this._13,this._E,this._F],this.set_theme({colors:this.colors,marker_color:"white",font_color:"white",background_colors:["black","#4a465a"]})},theme_37signals:function(){this._v="#339933",this._13="#cc99cc",this._11="#336699",this._12="#FFF804",this._D="#ff0000",this._E="#cf5910",this._G="black",this.colors=[this._12,this._11,this._v,this._D,this._13,this._E,this._G],this.set_theme({colors:this.colors,marker_color:"black",font_color:"black",background_colors:["#d1edf5","white"]})},theme_rails_keynote:function(){this._v="#00ff00",this._14="#333333",this._E="#ff5d00",this._D="#f61100",this._F="white",this._15="#999999",this._G="black",this.colors=[this._v,this._14,this._E,this._D,this._F,this._15,this._G],this.set_theme({colors:this.colors,marker_color:"white",font_color:"white",background_colors:["#0083a3","#0083a3"]})},theme_odeo:function(){this._14="#202020",this._F="white",this._1D="#a21764",this._v="#8ab438",this._15="#999999",this._1E="#3a5b87",this._G="black",this.colors=[this._14,this._F,this._1E,this._1D,this._v,this._15,this._G],this.set_theme({colors:this.colors,marker_color:"white",font_color:"white",background_colors:["#ff47a4","#ff1f81"]})},theme_pastel:function(){this.colors=["#a9dada","#aedaa9","#daaea9","#dadaa9","#a9a9da","#daaeda","#dadada"],this.set_theme({colors:this.colors,marker_color:"#aea9a9",font_color:"black",background_colors:"white"})},theme_greyscale:function(){this.colors=["#282828","#383838","#686868","#989898","#c8c8c8","#e8e8e8"],this.set_theme({colors:this.colors,marker_color:"#aea9a9",font_color:"black",background_colors:"white"})},data:function(t,e,i){e=void 0===e?[]:e,i=i||null,e=Bluff.array(e),this._1.push([t,e,i||this._1F()]),this._5=e.length>this._5?e.length:this._5,Bluff.each(e,function(t){void 0!==t&&(null===this.maximum_value&&null===this.minimum_value&&(this.maximum_value=this.minimum_value=t),this.maximum_value=this._1k(t)?t:this.maximum_value,this.maximum_value>=0&&(this._c=!0),this.minimum_value=this._1G(t)?t:this.minimum_value,this.minimum_value<0&&(this._c=!0))},this)},draw:function(){this.stacked&&this._1H(),this._1I(),this._x(function(){this._0.rectangle(this.left_margin,this.top_margin,this._b-this.right_margin,this._L-this.bottom_margin),this._0.rectangle(this._2,this._7,this._l,this._g)})},clear:function(){this._M()},on:function(t,e,i){var n=this._10[t]=this._10[t]||[];n.push([e,i])},trigger:function(t,e){var i=this._10[t];i&&Bluff.each(i,function(t){t[0].call(t[1],e)})},_1I:function(){return this._c?(this._16(),this._1K(),this.sort&&this._1L(),this._1M(),this._N(),this._1N(),this._1O(),void 0):this._1J()},_16:function(t){if(null===this._9||t===!0){if(this._9=[],!this._c)return;this._1l(),Bluff.each(this._1,function(t){var e=[];Bluff.each(t[this.klass.DATA_VALUES_INDEX],function(t){null===t||void 0===t?e.push(null):e.push((t-this.minimum_value)/this._i)},this),this._9.push([t[this.klass.DATA_LABEL_INDEX],e,t[this.klass.DATA_COLOR_INDEX]])},this)}},_1l:function(){this._i=this.maximum_value-this.minimum_value,this._i=this._i>0?this._i:1;var t=Math.round(Math.LOG10E*Math.log(this._i));this._1m=Math.pow(10,3-t)},_1K:function(){this._O=this.hide_line_markers?0:this._P(this.marker_font_size),this._1n=this.hide_title?0:this._P(this.title_font_size),this._1o=this.hide_legend?0:this._P(this.legend_font_size);var t,e,i,n,s,o,a;if(this.hide_line_markers)this._2=this.left_margin,this._17=this.right_margin,this._1p=this.bottom_margin;else{if(e=0,this.has_left_labels){t="";for(a in this.labels)t=t.length>this.labels[a].length?t:this.labels[a];e=1.25*this._H(this.marker_font_size,t)}else e=this._H(this.marker_font_size,this._Q(this.maximum_value));i=this.hide_line_numbers&&!this.has_left_labels?0:e+2*this.klass.LABEL_MARGIN,this._2=this.left_margin+i+(null===this.y_axis_label?0:this._O+2*this.klass.LABEL_MARGIN),n=-1/0;for(a in this.labels)n=n>Number(a)?n:Number(a);n=Math.round(n),s=n>=this._5-1&&this.center_labels_over_point?this._H(this.marker_font_size,this.labels[n])/2:0,this._17=this.right_margin+s,this._1p=this.bottom_margin+this._O+this.klass.LABEL_MARGIN}this._l=this._b-this._17,this._6=this._b-this._2-this._17,this._7=this.top_margin+(this.hide_title?this.title_margin:this._1n+this.title_margin)+(this.hide_legend?this.legend_margin:this._1o+this.legend_margin),o=null===this.x_axis_label?0:this._O+this.klass.LABEL_MARGIN,this._g=this._L-this._1p-o,this._3=this._g-this._7},_1N:function(){if(this.x_axis_label){var t=this._g+2*this.klass.LABEL_MARGIN+this._O;this._0.fill=this.font_color,this.font&&(this._0.font=this.font),this._0.stroke="transparent",this._0.pointsize=this._d(this.marker_font_size),this._0.gravity="north",this._0.annotate_scaled(this._b,1,0,t,this.x_axis_label,this._a),this._x(function(){this._0.line(0,t,this._b,t)})}},_N:function(){if(!this.hide_line_markers){null===this.y_axis_increment?(null===this.marker_count&&(Bluff.each([3,4,5,6,7],function(t){this.marker_count||0!==this._i%t||(this.marker_count=t)},this),this.marker_count=this.marker_count||4),this._18=this._i>0?this._19(this._i/this.marker_count):1):(this.maximum_value=Math.max(Math.ceil(this.maximum_value),this.y_axis_increment),this.minimum_value=Math.floor(this.minimum_value),this._1l(),this._16(!0),this.marker_count=Math.round(this._i/this.y_axis_increment),this._18=this.y_axis_increment),this._1P=this._3/(this._i/this._18);var t,e,i,n;for(t=0,e=this.marker_count;e>=t;t++)i=this._7+this._3-t*this._1P,this._0.stroke=this.marker_color,this._0.stroke_width=1,this._0.line(this._2,i,this._l,i),n=t*this._18+this.minimum_value,this.hide_line_numbers||(this._0.fill=this.font_color,this.font&&(this._0.font=this.font),this._0.font_weight="normal",this._0.stroke="transparent",this._0.pointsize=this._d(this.marker_font_size),this._0.gravity="east",this._0.annotate_scaled(this._2-this.klass.LABEL_MARGIN,1,0,i,this._Q(n),this._a))}},_1q:function(t){return(this._b-t)/2},_1M:function(){if(!this.hide_legend){this._I=Bluff.map(this._1,function(t){return t[this.klass.DATA_LABEL_INDEX]},this);var t=this.legend_box_size;this.font&&(this._0.font=this.font),this._0.pointsize=this.legend_font_size;var e=[[]];Bluff.each(this._I,function(i){var n=e.length-1,s=this._0.get_type_metrics(i),o=s.width+2.7*t;e[n].push(o),Bluff.sum(e[n])>.9*this._b&&e.push([e[n].pop()])},this);var i=this._1q(Bluff.sum(e[0])),n=this.hide_title?this.top_margin+this.title_margin:this.top_margin+this.title_margin+this._1n;this._x(function(){this._0.stroke_width=1,this._0.line(0,n,this._b,n)}),Bluff.each(this._I,function(s,o){this._0.fill=this.font_color,this.font&&(this._0.font=this.font),this._0.pointsize=this._d(this.legend_font_size),this._0.stroke="transparent",this._0.font_weight="normal",this._0.gravity="west",this._0.annotate_scaled(this._b,1,i+1.7*t,n,s,this._a),this._0.stroke="transparent",this._0.fill=this._1[o][this.klass.DATA_COLOR_INDEX],this._0.rectangle(i,n-t/2,i+t,n+t/2),this._0.pointsize=this.legend_font_size;var a,r=this._0.get_type_metrics(s),l=r.width+2.7*t;e[0].shift(),0==e[0].length?(this._x(function(){this._0.line(0,n,this._b,n)}),e.shift(),e.length>0&&(i=this._1q(Bluff.sum(e[0]))),a=Math.max(this._1o,t)+this.legend_margin,e.length>0&&(n+=a,this._7+=a,this._3=this._g-this._7)):i+=l},this),this._w=0}},_1O:function(){!this.hide_title&&this.title&&(this._0.fill=this.font_color,this.font&&(this._0.font=this.font),this._0.pointsize=this._d(this.title_font_size),this._0.font_weight="bold",this._0.gravity="north",this._0.annotate_scaled(this._b,1,0,this.top_margin,this.title,this._a))},_e:function(t,e){if(!this.hide_line_markers){var i;this.labels[e]&&!this._u[e]&&(i=this._g+this.klass.LABEL_MARGIN,this._0.fill=this.font_color,this.font&&(this._0.font=this.font),this._0.stroke="transparent",this._0.font_weight="normal",this._0.pointsize=this._d(this.marker_font_size),this._0.gravity="north",this._0.annotate_scaled(1,1,t,i,this.labels[e],this._a),this._u[e]=!0,this._x(function(){this._0.stroke_width=1,this._0.line(0,i,this._b,i)}))}},_y:function(t,e,i,n,s,o,a,r){if(this.tooltips){var l=this._0.tooltip(t,e,i,n,s,o,a);Bluff.Event.observe(l,"click",function(){var t={series:s,label:this.labels[r],value:a,color:o};this.trigger("click:datapoint",t)},this)}},_1J:function(){this._0.fill=this.font_color,this.font&&(this._0.font=this.font),this._0.stroke="transparent",this._0.font_weight="normal",this._0.pointsize=this._d(80),this._0.gravity="center",this._0.annotate_scaled(this._b,this._L/2,0,10,this.no_data_message,this._a)},_M:function(){var t=this._k.background_colors;switch(!0){case t instanceof Array:this._1Q.apply(this,t);break;case"string"==typeof t:this._1R(t);break;default:this._1S(this._k.background_image)}},_1R:function(t){this._0.render_solid_background(this._j,this._t,t)},_1Q:function(t,e){this._0.render_gradiated_background(this._j,this._t,t,e)},_1S:function(){},_1j:function(){this._w=0,this._u={},this._k={},this._0.scale(this._a,this._a)},_2k:function(t){return this._a*t},_d:function(t){var e=t*this._a;return e},_R:function(t,e){return t>e?e:t},_1k:function(t){return t>this.maximum_value},_1G:function(t){return t<this.minimum_value},_1r:function(t){return t},_2l:function(t){return t},_19:function(t){if(0==t)return 1;for(var e=1;10>t;)t*=10,e/=10;for(;t>100;)t/=10,e*=10;return Math.floor(t)*e},_1L:function(){var t=this._1T,e=this.klass.DATA_VALUES_INDEX;this._9.sort(function(i,n){return t(n[e])-t(i[e])}),this._1.sort(function(i,n){return t(n[e])-t(i[e])})},_1T:function(t){var e=0;return Bluff.each(t,function(t){e+=t||0}),e},_1H:function(){for(var t=[],e=this._5;e--;)t[e]=0;Bluff.each(this._1,function(e){Bluff.each(e[this.klass.DATA_VALUES_INDEX],function(e,i){t[i]+=e},this),e[this.klass.DATA_VALUES_INDEX]=Bluff.array(t)},this)},_x:function(t){this.klass.DEBUG&&(this._0.fill="transparent",this._0.stroke="turquoise",t.call(this))},_1F:function(){var t=this._w;return this._w=(this._w+1)%this.colors.length,this.colors[t]},_Q:function(t){var e=this.klass.THOUSAND_SEPARATOR,i=0==this._i%this.marker_count||null!==this.y_axis_increment?String(Math.round(t)):String(Math.floor(t*this._1m)/this._1m),n=i.split(".");return n[0]=n[0].replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1"+e),n.join(".")},_P:function(t){return this._0.caps_height(t)},_H:function(t,e){return this._0.text_width(t,e)}}),Bluff.Area=new JS.Class(Bluff.Base,{draw:function(){this.callSuper(),this._c&&(this._S=this._6/(this._5-1),this._0.stroke="transparent",Bluff.each(this._9,function(t){var e=[],i=0,n=0;Bluff.each(t[this.klass.DATA_VALUES_INDEX],function(t,s){var o=this._2+this._S*s,a=this._7+(this._3-t*this._3);i>0&&n>0?(e.push(o),e.push(a)):(e.push(this._2),e.push(this._g-1),e.push(o),e.push(a)),this._e(o,s),i=o,n=a},this),e.push(this._l),e.push(this._g-1),e.push(this._2),e.push(this._g-1),this._0.fill=t[this.klass.DATA_COLOR_INDEX],this._0.polyline(e)},this))}}),Bluff.BarConversion=new JS.Class({mode:null,zero:null,graph_top:null,graph_height:null,minimum_value:null,spread:null,getLeftYRightYscaled:function(t,e){var i;switch(this.mode){case 1:e[0]=this.graph_top+this.graph_height*(1-t)+1,e[1]=this.graph_top+this.graph_height-1;break;case 2:e[0]=this.graph_top+1,e[1]=this.graph_top+this.graph_height*(1-t)-1;break;case 3:i=t-this.minimum_value/this.spread,t>=this.zero?(e[0]=this.graph_top+this.graph_height*(1-(i-this.zero))+1,e[1]=this.graph_top+this.graph_height*(1-this.zero)-1):(e[0]=this.graph_top+this.graph_height*(1-(i-this.zero))+1,e[1]=this.graph_top+this.graph_height*(1-this.zero)-1);break;default:e[0]=0,e[1]=0}}}),Bluff.Bar=new JS.Class(Bluff.Base,{bar_spacing:.9,draw:function(){this.center_labels_over_point=Bluff.keys(this.labels).length>this._5,this.callSuper(),this._c&&this._T()},_T:function(){this._8=this._6/(this._5*this._1.length);var t=this._8*(1-this.bar_spacing)/2;this._0.stroke_opacity=0;var e=new Bluff.BarConversion;e.graph_height=this._3,e.graph_top=this._7,this.minimum_value>=0?e.mode=1:this.maximum_value<=0?e.mode=2:(e.mode=3,e.spread=this._i,e.minimum_value=this.minimum_value,e.zero=-this.minimum_value/this._i),Bluff.each(this._9,function(i,n){var s=this._1[n][this.klass.DATA_VALUES_INDEX];Bluff.each(i[this.klass.DATA_VALUES_INDEX],function(o,a){var r=this._2+this._8*(n+a+(this._1.length-1)*a)+t,l=r+this._8*this.bar_spacing,h=[];e.getLeftYRightYscaled(o,h),this._0.fill=i[this.klass.DATA_COLOR_INDEX],this._0.rectangle(r,h[0],l,h[1]),this._y(r,h[0],l-r,h[1]-h[0],i[this.klass.DATA_LABEL_INDEX],i[this.klass.DATA_COLOR_INDEX],s[a],a);var u=this._2+this._1.length*this._8*a+this._1.length*this._8/2;this._e(u-(this.center_labels_over_point?this._8/2:0),a)},this)},this),this.center_labels_over_point&&this._e(this._l,this._5)}}),Bluff.Line=new JS.Class(Bluff.Base,{baseline_value:null,baseline_color:null,line_width:null,dot_radius:null,hide_dots:null,hide_lines:null,initialize:function(t){if(arguments.length>3)throw"Wrong number of arguments";1===arguments.length||"number"!=typeof arguments[1]&&"string"!=typeof arguments[1]?this.callSuper(t,null):this.callSuper(),this.hide_dots=this.hide_lines=!1,this.baseline_color="red",this.baseline_value=null},draw:function(){if(this.callSuper(),this._c){this.x_increment=this._5>1?this._6/(this._5-1):this._6;var t;void 0!==this._U&&(t=this._7+(this._3-this._U*this._3),this._0.push(),this._0.stroke=this.baseline_color,this._0.fill_opacity=0,this._0.stroke_width=3,this._0.line(this._2,t,this._2+this._6,t),this._0.pop()),Bluff.each(this._9,function(t,e){var i=null,n=null,s=this._1[e][this.klass.DATA_VALUES_INDEX];this._1U=this._1V(t),Bluff.each(t[this.klass.DATA_VALUES_INDEX],function(e,o){var a=this._2+this.x_increment*o;if("number"==typeof e){this._e(a,o);var r=this._7+(this._3-e*this._3);this._0.stroke=t[this.klass.DATA_COLOR_INDEX],this._0.fill=t[this.klass.DATA_COLOR_INDEX],this._0.stroke_opacity=1,this._0.stroke_width=this.line_width||this._R(this._j/(6*this._9[0][this.klass.DATA_VALUES_INDEX].length),3);var l=this.dot_radius||this._R(this._j/(2*this._9[0][this.klass.DATA_VALUES_INDEX].length),7);this.hide_lines||null===i||null===n?this._1U&&this._0.circle(a,r,a-l,r):this._0.line(i,n,a,r),this.hide_dots||this._0.circle(a,r,a-l,r),this._y(a-l,r-l,2*l,2*l,t[this.klass.DATA_LABEL_INDEX],t[this.klass.DATA_COLOR_INDEX],s[o],o),i=a,n=r}},this)},this)}},_16:function(){this.maximum_value=Math.max(this.maximum_value,this.baseline_value),this.callSuper(),null!==this.baseline_value&&(this._U=this.baseline_value/this.maximum_value)},_1V:function(t){var e=0;return Bluff.each(t[this.klass.DATA_VALUES_INDEX],function(t){void 0!==t&&(e+=1)}),1===e}}),Bluff.Dot=new JS.Class(Bluff.Base,{draw:function(){if(this.has_left_labels=!0,this.callSuper(),this._c){var t=1;this._J=this._3/this._5,this._1a=this._J*t/this._9.length,this._0.stroke_opacity=0;var e=(Bluff.array_new(this._5,0),Bluff.array_new(this._5,this._2),this._J*(1-t)/2);Bluff.each(this._9,function(t,i){Bluff.each(t[this.klass.DATA_VALUES_INDEX],function(n,s){var o=this._2+n*this._6-Math.round(this._1a/6),a=this._7+this._J*s+e+Math.round(this._1a/2);0===i&&(this._0.stroke=this.marker_color,this._0.stroke_width=1,this._0.opacity=.1,this._0.line(this._2,a,this._2+this._6,a)),this._0.fill=t[this.klass.DATA_COLOR_INDEX],this._0.stroke="transparent",this._0.circle(o,a,o+Math.round(this._1a/3),a);var r=this._7+(this._J*s+this._J/2)+e;this._e(r,s)},this)},this)}},_N:function(){if(!this.hide_line_markers){this._0.stroke_antialias=!1,this._0.stroke_width=1;for(var t=5,e=this._19(this.maximum_value/t),i=0;t>=i;i++){var n=(this._l-this._2)/t,s=this._l-n*i-1,o=i-t,a=Math.abs(o)*e;this._0.stroke=this.marker_color,this._0.line(s,this._g,s,this._g+.5*this.klass.LABEL_MARGIN),this.hide_line_numbers||(this._0.fill=this.font_color,this.font&&(this._0.font=this.font),this._0.stroke="transparent",this._0.pointsize=this._d(this.marker_font_size),this._0.gravity="center",this._0.annotate_scaled(0,0,s,this._g+2*this.klass.LABEL_MARGIN,a,this._a)),this._0.stroke_antialias=!0}}},_e:function(t,e){this.labels[e]&&!this._u[e]&&(this._0.fill=this.font_color,this.font&&(this._0.font=this.font),this._0.stroke="transparent",this._0.font_weight="normal",this._0.pointsize=this._d(this.marker_font_size),this._0.gravity="east",this._0.annotate_scaled(1,1,this._2-2*this.klass.LABEL_MARGIN,t,this.labels[e],this._a),this._u[e]=!0)}}),Bluff.Net=new JS.Class(Bluff.Base,{hide_dots:null,line_width:null,dot_radius:null,initialize:function(){this.callSuper(),this.hide_dots=!1,this.hide_line_numbers=!0},draw:function(){if(this.callSuper(),this._c){this._z=this._3/2,this._A=this._2+this._6/2,this._B=this._7+this._3/2-10,this._S=this._6/(this._5-1);var t=this.dot_radius||this._R(this._j/(2.5*this._9[0][this.klass.DATA_VALUES_INDEX].length),7);this._0.stroke_opacity=1,this._0.stroke_width=this.line_width||this._R(this._j/(4*this._9[0][this.klass.DATA_VALUES_INDEX].length),3);var e;void 0!==this._U&&(e=this._7+(this._3-this._U*this._3),this._0.push(),this._0.stroke_color=this.baseline_color,this._0.fill_opacity=0,this._0.stroke_width=5,this._0.line(this._2,e,this._2+this._6,e),this._0.pop()),Bluff.each(this._9,function(e){Bluff.each(e[this.klass.DATA_VALUES_INDEX],function(i,n){if(void 0!==i){var s=2*n*Math.PI/this._5,o=i*this._z,a=this._A+Math.sin(s)*o,r=this._B-Math.cos(s)*o,l=n+1<e[this.klass.DATA_VALUES_INDEX].length?n+1:0,h=2*l*Math.PI/this._5,u=e[this.klass.DATA_VALUES_INDEX][l]*this._z,c=this._A+Math.sin(h)*u,f=this._B-Math.cos(h)*u;this._0.stroke=e[this.klass.DATA_COLOR_INDEX],this._0.fill=e[this.klass.DATA_COLOR_INDEX],this._0.line(a,r,c,f),this.hide_dots||this._0.circle(a,r,a-t,r)}},this)},this)}},_N:function(){if(!this.hide_line_markers){this._z=this._3/2,this._A=this._2+this._6/2,this._B=this._7+this._3/2-10;for(var t,e,i=0,n=this._5;n>i;i++)t=2*i*Math.PI/this._5,this._0.stroke=this.marker_color,this._0.stroke_width=1,this._0.line(this._A,this._B,this._A+Math.sin(t)*this._z,this._B-Math.cos(t)*this._z),e=this.labels[i]?this.labels[i]:"000",this._e(this._A,this._B,360*t/(2*Math.PI),this._z,e)}},_e:function(t,e,i,n,s){var o=1.1,a=t,r=e,l=i*Math.PI/180,h=a+n*o*Math.sin(l),u=r-n*o*Math.cos(l);this._0.fill=this.marker_color,this.font&&(this._0.font=this.font),this._0.pointsize=this._d(20),this._0.stroke="transparent",this._0.font_weight="bold",this._0.gravity="center",this._0.annotate_scaled(0,0,h,u,s,this._a)}}),Bluff.Pie=new JS.Class(Bluff.Base,{extend:{TEXT_OFFSET_PERCENTAGE:.08},zero_degreee:null,hide_labels_less_than:null,initialize_ivars:function(){this.callSuper(),this.zero_degree=0,this.hide_labels_less_than=0},draw:function(){if(this.hide_line_markers=!0,this.callSuper(),this._c){var t=this._3,e=.8*(Math.min(this._6,this._3)/2),i=(this._2+(this._6-t)/2,this._2+this._6/2),n=this._7+this._3/2-10,s=this._1W(),o=this.zero_degree,a=this.klass.DATA_VALUES_INDEX;this.sort&&this._1.sort(function(t,e){return t[a][0]-e[a][0]}),Bluff.each(this._1,function(t,a){if(t[this.klass.DATA_VALUES_INDEX][0]>0){this._0.fill=t[this.klass.DATA_COLOR_INDEX];var r=360*(t[this.klass.DATA_VALUES_INDEX][0]/s);this._0.circle(i,n,i+e,n,o,o+r+.5);var l,h=o+(o+r-o)/2,u=Math.round(100*(t[this.klass.DATA_VALUES_INDEX][0]/s));u>=this.hide_labels_less_than&&(l=this._Q(t[this.klass.DATA_VALUES_INDEX][0]),this._e(i,n,h,e+e*this.klass.TEXT_OFFSET_PERCENTAGE,l,t,a)),o+=r}},this)}},_e:function(t,e,i,n,s,o,a){var r=20,l=t,h=e,u=n+r,c=.15*u,f=l+(u+c)*Math.cos(i*Math.PI/180),d=h+u*Math.sin(i*Math.PI/180);this._0.fill=this.font_color,this.font&&(this._0.font=this.font),this._0.pointsize=this._d(this.marker_font_size),this._0.font_weight="bold",this._0.gravity="center",this._0.annotate_scaled(0,0,f,d,s,this._a),this._y(f-20,d-20,40,40,o[this.klass.DATA_LABEL_INDEX],o[this.klass.DATA_COLOR_INDEX],s,a)},_1W:function(){var t=0;return Bluff.each(this._1,function(e){t+=e[this.klass.DATA_VALUES_INDEX][0]},this),t}}),Bluff.SideBar=new JS.Class(Bluff.Base,{bar_spacing:.9,draw:function(){this.has_left_labels=!0,this.callSuper(),this._c&&this._T()},_T:function(){this._V=this._3/this._5,this._8=this._V/this._9.length,this._0.stroke_opacity=0;var t=Bluff.array_new(this._5,0),e=Bluff.array_new(this._5,this._2),i=this._8*(1-this.bar_spacing)/2;Bluff.each(this._9,function(n,s){var o=this._1[s][this.klass.DATA_VALUES_INDEX];Bluff.each(n[this.klass.DATA_VALUES_INDEX],function(a,r){var l=this._2+(this._6-a*this._6-t[r]),h=this._2+this._6-t[r],u=h-l,c=e[r]-1,f=this._7+this._V*r+this._8*s+i,d=c+u,p=f+this._8*this.bar_spacing;t[r]+=a*this._6,this._0.stroke="transparent",this._0.fill=n[this.klass.DATA_COLOR_INDEX],this._0.rectangle(c,f,d,p),this._y(c,f,d-c,p-f,n[this.klass.DATA_LABEL_INDEX],n[this.klass.DATA_COLOR_INDEX],o[r],r);var _=this._7+(this._V*r+this._V/2);this._e(_,r)},this)},this)},_N:function(){if(!this.hide_line_markers){this._0.stroke_antialias=!1,this._0.stroke_width=1;for(var t,e,i,n,s=5,o=this._19(this._i/s),a=0;s>=a;a++)t=(this._l-this._2)/s,e=this._l-t*a-1,i=a-s,n=Math.abs(i)*o+this.minimum_value,this._0.stroke=this.marker_color,this._0.line(e,this._g,e,this._7),this.hide_line_numbers||(this._0.fill=this.font_color,this.font&&(this._0.font=this.font),this._0.stroke="transparent",this._0.pointsize=this._d(this.marker_font_size),this._0.gravity="center",this._0.annotate_scaled(0,0,e,this._g+2*this.klass.LABEL_MARGIN,this._Q(n),this._a))}},_e:function(t,e){this.labels[e]&&!this._u[e]&&(this._0.fill=this.font_color,this.font&&(this._0.font=this.font),this._0.stroke="transparent",this._0.font_weight="normal",this._0.pointsize=this._d(this.marker_font_size),this._0.gravity="east",this._0.annotate_scaled(1,1,this._2-2*this.klass.LABEL_MARGIN,t,this.labels[e],this._a),this._u[e]=!0)}}),Bluff.Spider=new JS.Class(Bluff.Base,{hide_text:null,hide_axes:null,transparent_background:null,initialize:function(t,e,i){this.callSuper(t,i),this._1X=e,this.hide_legend=!0},draw:function(){if(this.hide_line_markers=!0,this.callSuper(),this._c){var t=this._3,e=this._3/2,i=(this._2+(this._6-t)/2,this._2+this._6/2),n=this._7+this._3/2-25;this._1Y=e/this._1X;var s=(this._1Z(),2*Math.PI/this._1.length);this.hide_axes||this._20(i,n,e,s),this._21(i,n,s)}},_1s:function(t){return t*this._1Y},_e:function(t,e,i,n,s){var o=50,a=t,r=e+0,l=a+(n+o)*Math.cos(i),h=r+(n+o)*Math.sin(i);this._0.fill=this.marker_color,this.font&&(this._0.font=this.font),this._0.pointsize=this._d(this.legend_font_size),this._0.stroke="transparent",this._0.font_weight="bold",this._0.gravity="center",this._0.annotate_scaled(0,0,l,h,s,this._a)},_20:function(t,e,i,n,s){if(!this.hide_axes){var o=0;Bluff.each(this._1,function(a){this._0.stroke=s||a[this.klass.DATA_COLOR_INDEX],this._0.stroke_width=5;var r=i*Math.cos(o),l=i*Math.sin(o);this._0.line(t,e,t+r,e+l),this.hide_text||this._e(t,e,o,i,a[this.klass.DATA_LABEL_INDEX]),o+=n},this)}},_21:function(t,e,i,n){var s=[],o=0;Bluff.each(this._1,function(n){s.push(t+this._1s(n[this.klass.DATA_VALUES_INDEX][0])*Math.cos(o)),s.push(e+this._1s(n[this.klass.DATA_VALUES_INDEX][0])*Math.sin(o)),o+=i},this),this._0.stroke_width=1,this._0.stroke=n||this.marker_color,this._0.fill=n||this.marker_color,this._0.fill_opacity=.4,this._0.polyline(s)},_1Z:function(){var t=0;return Bluff.each(this._1,function(e){t+=e[this.klass.DATA_VALUES_INDEX][0]},this),t}}),Bluff.Base.StackedMixin=new JS.Module({_1b:function(){var t={};Bluff.each(this._1,function(e){Bluff.each(e[this.klass.DATA_VALUES_INDEX],function(e,i){t[i]||(t[i]=0),t[i]+=e},this)},this);for(var e in t)t[e]>this.maximum_value&&(this.maximum_value=t[e]);this.minimum_value=0}}),Bluff.StackedArea=new JS.Class(Bluff.Base,{include:Bluff.Base.StackedMixin,last_series_goes_on_bottom:null,draw:function(){if(this._1b(),this.callSuper(),this._c){this._S=this._6/(this._5-1),this._0.stroke="transparent";var t=Bluff.array_new(this._5,0),e=null,i=this.last_series_goes_on_bottom?"reverse_each":"each";Bluff[i](this._9,function(i){var n=e;e=[],Bluff.each(i[this.klass.DATA_VALUES_INDEX],function(i,n){var s=this._2+this._S*n,o=this._7+(this._3-i*this._3-t[n]);t[n]+=i*this._3,e.push(s),e.push(o),this._e(s,n)},this);var s,o;if(n){for(s=Bluff.array(e),o=n.length/2-1;o>=0;o--)s.push(n[2*o]),s.push(n[2*o+1]);s.push(e[0]),s.push(e[1])}else s=Bluff.array(e),s.push(this._l),s.push(this._g-1),s.push(this._2),s.push(this._g-1),s.push(e[0]),s.push(e[1]);this._0.fill=i[this.klass.DATA_COLOR_INDEX],this._0.polyline(s)},this)}}}),Bluff.StackedBar=new JS.Class(Bluff.Base,{include:Bluff.Base.StackedMixin,bar_spacing:.9,draw:function(){if(this._1b(),this.callSuper(),this._c){this._8=this._6/this._5;var t=this._8*(1-this.bar_spacing)/2;this._0.stroke_opacity=0;var e=Bluff.array_new(this._5,0);Bluff.each(this._9,function(i,n){var s=this._1[n][this.klass.DATA_VALUES_INDEX];Bluff.each(i[this.klass.DATA_VALUES_INDEX],function(n,o){var a=this._2+this._8*o+this._8*this.bar_spacing/2;if(this._e(a,o),0!=n){var r=this._2+this._8*o+t,l=this._7+(this._3-n*this._3-e[o])+1,h=r+this._8*this.bar_spacing,u=this._7+this._3-e[o]-1;e[o]+=n*this._3,this._0.fill=i[this.klass.DATA_COLOR_INDEX],this._0.rectangle(r,l,h,u),this._y(r,l,h-r,u-l,i[this.klass.DATA_LABEL_INDEX],i[this.klass.DATA_COLOR_INDEX],s[o],o)}},this)},this)}}}),Bluff.AccumulatorBar=new JS.Class(Bluff.StackedBar,{draw:function(){if(1!==this._1.length)throw"Incorrect number of datasets";var t=[],e=0,i=[];Bluff.each(this._1[0][this.klass.DATA_VALUES_INDEX],function(n){var s=-1/0;Bluff.each(i,function(t){s=Math.max(s,t)}),i.push(e>0?n+s:n),t.push(i[e]-n),e+=1},this),this.data("Accumulator",t),this.callSuper()}}),Bluff.SideStackedBar=new JS.Class(Bluff.SideBar,{include:Bluff.Base.StackedMixin,bar_spacing:.9,draw:function(){this.has_left_labels=!0,this._1b(),this.callSuper()},_T:function(){this._8=this._3/this._5;var t=Bluff.array_new(this._5,0),e=Bluff.array_new(this._5,this._2),i=this._8*(1-this.bar_spacing)/2;Bluff.each(this._9,function(n,s){var o=this._1[s][this.klass.DATA_VALUES_INDEX];Bluff.each(n[this.klass.DATA_VALUES_INDEX],function(s,a){var r=this._2+(this._6-s*this._6-t[a])+1,l=this._2+this._6-t[a]-1,h=l-r;this._0.fill=n[this.klass.DATA_COLOR_INDEX];var u=e[a],c=this._7+this._8*a+i,f=u+h,d=c+this._8*this.bar_spacing;e[a]+=h,t[a]+=s*this._6-2,this._0.rectangle(u,c,f,d),this._y(u,c,f-u,d-c,n[this.klass.DATA_LABEL_INDEX],n[this.klass.DATA_COLOR_INDEX],o[a],a);var p=this._7+this._8*a+this._8*this.bar_spacing/2;this._e(p,a)},this)},this)},_1k:function(t,e){return e=e||0,this._1r(t,e)>this.maximum_value},_1r:function(t,e){var i=0;return Bluff.each(this._1,function(t){i+=t[this.klass.DATA_VALUES_INDEX][e]},this),i}}),Bluff.Mini.Legend=new JS.Module({hide_mini_legend:!1,_1c:function(){if(!this.hide_mini_legend){this._I=Bluff.map(this._1,function(t){return t[this.klass.DATA_LABEL_INDEX]},this);var t=this._d(this._1.length*this._1t()+this.top_margin+this.bottom_margin);switch(this._22=this._L,this._23=this._b,this.legend_position){case"right":this._t=Math.max(this._t,t),this._j+=this._24()+this.left_margin;break;default:this._t+=t}this._M()}},_1t:function(){return 1.7*this._P(this.legend_font_size)},_24:function(){var t=0;return Bluff.each(this._I,function(e){t=Math.max(this._H(this.legend_font_size,e),t)},this),this._d(t+68)},_1d:function(){if(!this.hide_mini_legend){var t=40,e=100,i=40;this.font&&(this._0.font=this.font),this._0.pointsize=this.legend_font_size;var n,s;switch(this.legend_position){case"right":n=this._23+this.left_margin,s=this.top_margin+i;break;default:n=e,s=this._22+i}this._x(function(){this._0.line(0,s,this._b,s)}),Bluff.each(this._I,function(e,i){this._0.fill=this.font_color,this.font&&(this._0.font=this.font),this._0.pointsize=this._d(this.legend_font_size),this._0.stroke="transparent",this._0.font_weight="normal",this._0.gravity="west",this._0.annotate_scaled(this._b,1,n+1.7*t,s,this._25(e),this._a),this._0.stroke="transparent",this._0.fill=this._1[i][this.klass.DATA_COLOR_INDEX],this._0.rectangle(n,s-t/2,n+t,s+t/2),s+=this._1t()},this),this._w=0}},_25:function(t){for(var e=String(t);this._H(this._d(this.legend_font_size),e)>this._j-this.legend_left_margin-this.right_margin&&e.length>1;)e=e.substr(0,e.length-1);return e+(e.length<String(t).length?"...":"")}}),Bluff.Mini.Bar=new JS.Class(Bluff.Bar,{include:Bluff.Mini.Legend,initialize_ivars:function(){this.callSuper(),this.hide_legend=!0,this.hide_title=!0,this.hide_line_numbers=!0,this.marker_font_size=50,this.minimum_value=0,this.maximum_value=0,this.legend_font_size=60},draw:function(){this._1c(),this.callSuper(),this._1d()}}),Bluff.Mini.Pie=new JS.Class(Bluff.Pie,{include:Bluff.Mini.Legend,initialize_ivars:function(){this.callSuper(),this.hide_legend=!0,this.hide_title=!0,this.hide_line_numbers=!0,this.marker_font_size=60,this.legend_font_size=60},draw:function(){this._1c(),this.callSuper(),this._1d()}}),Bluff.Mini.SideBar=new JS.Class(Bluff.SideBar,{include:Bluff.Mini.Legend,initialize_ivars:function(){this.callSuper(),this.hide_legend=!0,this.hide_title=!0,this.hide_line_numbers=!0,this.marker_font_size=50,this.legend_font_size=50},draw:function(){this._1c(),this.callSuper(),this._1d()}}),Bluff.Renderer=new JS.Class({extend:{WRAPPER_CLASS:"bluff-wrapper",TEXT_CLASS:"bluff-text",TARGET_CLASS:"bluff-tooltip-target"},font:"Arial, Helvetica, Verdana, sans-serif",gravity:"north",initialize:function(t){this._n=document.getElementById(t),this._4=this._n.getContext("2d")},scale:function(t,e){this._f=t,this._h=e||t
},caps_height:function(t){var e=this._W(t,"X"),i=this._K(e).height;return this._X(e),i},text_width:function(t,e){var i=this._W(t,e),n=this._K(i).width;return this._X(i),n},get_type_metrics:function(t){var e=this._W(this.pointsize,t);document.body.appendChild(e);var i=this._K(e);return this._X(e),i},clear:function(t,e){this._n.width=t,this._n.height=e,this._4.clearRect(0,0,t,e);var i=this._1u(),n=i.childNodes,s=n.length;for(i.style.width=t+"px",i.style.height=e+"px";s--;)"canvas"!==n[s].tagName.toLowerCase()&&(Bluff.Event.stopObserving(n[s]),this._X(n[s]))},push:function(){this._4.save()},pop:function(){this._4.restore()},render_gradiated_background:function(t,e,i,n){this.clear(t,e);var s=this._4.createLinearGradient(0,0,0,e);s.addColorStop(0,i),s.addColorStop(1,n),this._4.fillStyle=s,this._4.fillRect(0,0,t,e)},render_solid_background:function(t,e,i){this.clear(t,e),this._4.fillStyle=i,this._4.fillRect(0,0,t,e)},annotate_scaled:function(t,e,i,n,s,o){var a=t*o>=1?t*o:1,r=e*o>=1?e*o:1,s=this._W(this.pointsize,s);s.style.color=this.fill,s.style.cursor="default",s.style.fontWeight=this.font_weight,s.style.textAlign="center",s.style.left=this._f*i+this._26(s,a)+"px",s.style.top=this._h*n+this._27(s,r)+"px"},tooltip:function(t,e,i,n,s,o,a){0>i&&(t+=i),0>n&&(e+=n);var r=this._n.parentNode,l=document.createElement("div");return l.className=this.klass.TARGET_CLASS,l.style.cursor="default",l.style.position="absolute",l.style.left=this._f*t-3+"px",l.style.top=this._h*e-3+"px",l.style.width=this._f*Math.abs(i)+5+"px",l.style.height=this._h*Math.abs(n)+5+"px",l.style.fontSize=0,l.style.overflow="hidden",Bluff.Event.observe(l,"mouseover",function(){Bluff.Tooltip.show(s,o,a)}),Bluff.Event.observe(l,"mouseout",function(){Bluff.Tooltip.hide()}),r.appendChild(l),l},circle:function(t,e,i,n,s,o){var a=Math.sqrt(Math.pow(i-t,2)+Math.pow(n-e,2)),r=0,l=2*Math.PI;this._4.fillStyle=this.fill,this._4.beginPath(),void 0!==s&&void 0!==o&&360!==Math.abs(Math.floor(o-s))&&(r=s*Math.PI/180,l=o*Math.PI/180,this._4.moveTo(this._f*(t+a*Math.cos(l)),this._h*(e+a*Math.sin(l))),this._4.lineTo(this._f*t,this._h*e),this._4.lineTo(this._f*(t+a*Math.cos(r)),this._h*(e+a*Math.sin(r)))),this._4.arc(this._f*t,this._h*e,this._f*a,r,l,!1),this._4.fill()},line:function(t,e,i,n){this._4.strokeStyle=this.stroke,this._4.lineWidth=this.stroke_width,this._4.beginPath(),this._4.moveTo(this._f*t,this._h*e),this._4.lineTo(this._f*i,this._h*n),this._4.stroke()},polyline:function(t){this._4.fillStyle=this.fill,this._4.globalAlpha=this.fill_opacity||1;try{this._4.strokeStyle=this.stroke}catch(e){}var i=t.shift(),n=t.shift();for(this._4.beginPath(),this._4.moveTo(this._f*i,this._h*n);t.length>0;)i=t.shift(),n=t.shift(),this._4.lineTo(this._f*i,this._h*n);this._4.fill()},rectangle:function(t,e,i,n){var s;t>i&&(s=t,t=i,i=s),e>n&&(s=e,e=n,n=s);try{this._4.fillStyle=this.fill,this._4.fillRect(this._f*t,this._h*e,this._f*(i-t),this._h*(n-e))}catch(o){}try{this._4.strokeStyle=this.stroke,"transparent"!==this.stroke&&this._4.strokeRect(this._f*t,this._h*e,this._f*(i-t),this._h*(n-e))}catch(o){}},_26:function(t,e){var i=this._K(t).width;switch(this.gravity){case"west":return 0;case"east":return e-i;case"north":case"south":case"center":return(e-i)/2}},_27:function(t,e){var i=this._K(t).height;switch(this.gravity){case"north":return 0;case"south":return e-i;case"west":case"east":case"center":return(e-i)/2}},_1u:function(){var t=this._n.parentNode;return t.className===this.klass.WRAPPER_CLASS?t:(t=document.createElement("div"),t.className=this.klass.WRAPPER_CLASS,t.style.position="relative",t.style.border="none",t.style.padding="0 0 0 0",this._n.parentNode.insertBefore(t,this._n),t.appendChild(this._n),t)},_W:function(t,e){var i=this._28(e);return i.style.fontFamily=this.font,i.style.fontSize="number"==typeof t?t+"px":t,i},_28:function(t){var e=document.createElement("div");return e.className=this.klass.TEXT_CLASS,e.style.position="absolute",e.appendChild(document.createTextNode(t)),this._1u().appendChild(e),e},_X:function(t){t.parentNode.removeChild(t),t.className===this.klass.TARGET_CLASS&&Bluff.Event.stopObserving(t)},_K:function(t){var e=t.style.display;return e&&"none"!==e?{width:t.offsetWidth,height:t.offsetHeight}:{width:t.clientWidth,height:t.clientHeight}}}),Bluff.Event={_Y:[],_1v:window.attachEvent&&-1===navigator.userAgent.indexOf("Opera"),observe:function(t,e,i,n){var s=Bluff.map(this._1w(t,e),function(t){return t._29});if(-1===Bluff.index(s,i)){var o=function(e){i.call(n||null,t,Bluff.Event._2a(e))};this._Y.push({_Z:t,_1e:e,_29:i,_1x:o}),t.addEventListener?t.addEventListener(e,o,!1):t.attachEvent("on"+e,o)}},stopObserving:function(t){var e=t?this._1w(t):this._Y;Bluff.each(e,function(t){t._Z.removeEventListener?t._Z.removeEventListener(t._1e,t._1x,!1):t._Z.detachEvent("on"+t._1e,t._1x)})},_1w:function(t,e){var i=[];return Bluff.each(this._Y,function(n){t&&n._Z!==t||e&&n._1e!==e||i.push(n)}),i},_2a:function(t){if(!this._1v)return t;if(!t)return!1;if(t._2b)return t;t._2b=!0;var e=this._2c(t);return t.target=t.srcElement,t.pageX=e.x,t.pageY=e.y,t},_2c:function(t){var e=document.documentElement,i=document.body||{scrollLeft:0,scrollTop:0};return{x:t.pageX||t.clientX+(e.scrollLeft||i.scrollLeft)-(e.clientLeft||0),y:t.pageY||t.clientY+(e.scrollTop||i.scrollTop)-(e.clientTop||0)}}},Bluff.Event._1v&&window.attachEvent("onunload",function(){Bluff.Event.stopObserving(),Bluff.Event._Y=null}),navigator.userAgent.indexOf("AppleWebKit/")>-1&&window.addEventListener("unload",function(){},!1),Bluff.Tooltip=new JS.Singleton({LEFT_OFFSET:20,TOP_OFFSET:-6,DATA_LENGTH:8,CLASS_NAME:"bluff-tooltip",setup:function(){this._o=document.createElement("div"),this._o.className=this.CLASS_NAME,this._o.style.position="absolute",this.hide(),document.body.appendChild(this._o),Bluff.Event.observe(document.body,"mousemove",function(t,e){this._o.style.left=e.pageX+this.LEFT_OFFSET+"px",this._o.style.top=e.pageY+this.TOP_OFFSET+"px"},this)},show:function(t,e,i){i=Number(String(i).substr(0,this.DATA_LENGTH)),this._o.innerHTML='<span class="color" style="background: '+e+';">&nbsp;</span> <span class="label">'+t+'</span> <span class="data">'+i+"</span>",this._o.style.display=""},hide:function(){this._o.style.display="none"}}),Bluff.Event.observe(window,"load",Bluff.Tooltip.method("setup")),Bluff.TableReader=new JS.Class({NUMBER_FORMAT:/\-?(0|[1-9]\d*)(\.\d+)?(e[\+\-]?\d+)?/i,initialize:function(t,e){this._1f=e||{},this._2d=this._1f.orientation||"auto",this._2e="string"==typeof t?document.getElementById(t):t},get_data:function(){return this._1||this._1y(),this._1},get_labels:function(){return this._1g||this._1y(),this._1g},get_title:function(){return this._2f},get_series:function(t){return this._1[t]?this._1[t]:this._1[t]={points:[]}},_1y:function(){this._C=this._m=0,this._p=this._q=0,this._1=[],this._1g={},this._r=[],this._s=[],this._1h=[],this._1i=[],this._1z(this._2e),this._2g(),this._2h(),Bluff.each(this._s,function(t,e){this.get_series(e-this._q).name=t},this),Bluff.each(this._r,function(t,e){this._1g[e-this._p]=t},this)},_1z:function(t){this._2i(t);var e,i=t.childNodes,n=i.length;for(e=0;n>e;e++)this._1z(i[e])},_2i:function(t){if(t.tagName){var e,i,n=this._1A(t.innerHTML);switch(t.tagName.toUpperCase()){case"TR":this._c||(this._p=this._C),this._C+=1,this._m=0;break;case"TD":this._c||(this._q=this._m),this._c=!0,this._m+=1,n=n.match(this.NUMBER_FORMAT),null===n?this.get_series(e).points[i]=null:(e=this._m-this._q-1,i=this._C-this._p-1,this.get_series(e).points[i]=parseFloat(n[0]));break;case"TH":this._m+=1,this._2j(t)&&(this._1i.push(this._m),this._1h.push(this._C)),1===this._m&&1===this._C?this._r[0]=this._s[0]=n:"row"===t.scope||1===this._m?this._r[this._C-1]=n:this._s[this._m-1]=n;break;case"CAPTION":this._2f=n}}},_2j:function(t){if(!this._1f.except)return!1;var e=this._1A(t.innerHTML),i=(t.className||"").split(/\s+/),n=[].concat(this._1f.except);if(Bluff.index(n,e)>=0)return!0;for(var s=i.length;s--;)if(Bluff.index(n,i[s])>=0)return!0;return!1},_2g:function(){for(var t,e=this._1i.length;e--;)t=this._1i[e],t<=this._q||(this._s.splice(t-1,1),t>=this._q&&this._1.splice(t-1-this._q,1));for(var t,e=this._1h.length;e--;)t=this._1h[e],t<=this._p||(this._r.splice(t-1,1),Bluff.each(this._1,function(e){t>=this._p&&e.points.splice(t-1-this._p,1)},this))},_2h:function(){switch(this._2d){case"auto":(this._r.length>1&&1===this._s.length||this._r.length<this._s.length)&&this._1B();break;case"rows":this._1B()}},_1B:function(){var t,e=this._1;this._1=[],Bluff.each(e,function(t,e){Bluff.each(t.points,function(t,i){this.get_series(i).points[e]=t},this)},this),t=this._r,this._r=this._s,this._s=t,t=this._p,this._p=this._q,this._q=t},_1A:function(t){return t.replace(/<\/?[^>]+>/gi,"")},extend:{Mixin:new JS.Module({data_from_table:function(t,e){var i=new Bluff.TableReader(t,e),n=i.get_data();Bluff.each(n,function(t){this.data(t.name,t.points)},this),this.labels=i.get_labels(),this.title=i.get_title()||this.title}})}}),Bluff.Base.include(Bluff.TableReader.Mixin);