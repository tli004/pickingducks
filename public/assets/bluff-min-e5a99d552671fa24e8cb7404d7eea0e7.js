Bluff={VERSION:"0.3.6",array:function(t){if(void 0===t.length)return[t];for(var i=[],s=t.length;s--;)i[s]=t[s];return i},array_new:function(t,i){for(var s=[];t--;)s.push(i);return s},each:function(t,i,s){for(var h=0,_=t.length;_>h;h++)i.call(s||null,t[h],h)},index:function(t,i){for(var s=0,h=t.length;h>s;s++)if(t[s]===i)return s;return-1},keys:function(t){var i,s=[];for(i in t)s.push(i);return s},map:function(t,i,s){var h=[];return this.each(t,function(t){h.push(i.call(s||null,t))}),h},reverse_each:function(t,i,s){for(var h=t.length;h--;)i.call(s||null,t[h],h)},sum:function(t){for(var i=0,s=t.length;s--;)i+=t[s];return i},Mini:{}},Bluff.Base=new JS.Class({extend:{DEBUG:!1,DATA_LABEL_INDEX:0,DATA_VALUES_INDEX:1,DATA_COLOR_INDEX:2,LEGEND_MARGIN:20,TITLE_MARGIN:20,LABEL_MARGIN:10,DEFAULT_MARGIN:20,DEFAULT_TARGET_WIDTH:800,THOUSAND_SEPARATOR:","},top_margin:null,bottom_margin:null,right_margin:null,left_margin:null,title_margin:null,legend_margin:null,labels:null,center_labels_over_point:null,has_left_labels:null,x_axis_label:null,y_axis_label:null,y_axis_increment:null,colors:null,title:null,font:null,font_color:null,hide_line_markers:null,hide_legend:null,hide_title:null,hide_line_numbers:null,no_data_message:null,title_font_size:null,legend_font_size:null,marker_font_size:null,marker_color:null,marker_count:null,minimum_value:null,maximum_value:null,sort:null,additional_line_values:null,stacked:null,legend_box_size:null,tooltips:!1,initialize:function(t,i){this._0=new Bluff.Renderer(t),i=i||this.klass.DEFAULT_TARGET_WIDTH;var s;"number"!=typeof i?(s=i.split("x"),this._j=parseFloat(s[0]),this._t=parseFloat(s[1])):(this._j=parseFloat(i),this._t=.75*this._j),this.initialize_ivars(),this._1j(),this.theme_keynote(),this._10={}},initialize_ivars:function(){this._b=800,this._L=800*(this._t/this._j),this._5=0,this.marker_count=null,this.maximum_value=this.minimum_value=null,this._c=!1,this._1=[],this.labels={},this._u={},this.sort=!0,this.title=null,this._a=this._j/this._b,this.marker_font_size=21,this.legend_font_size=20,this.title_font_size=36,this.top_margin=this.bottom_margin=this.left_margin=this.right_margin=this.klass.DEFAULT_MARGIN,this.legend_margin=this.klass.LEGEND_MARGIN,this.title_margin=this.klass.TITLE_MARGIN,this.legend_box_size=20,this.no_data_message="No Data",this.hide_line_markers=this.hide_legend=this.hide_title=this.hide_line_numbers=!1,this.center_labels_over_point=!0,this.has_left_labels=!1,this.additional_line_values=[],this._1C=[],this._k={},this.x_axis_label=this.y_axis_label=null,this.y_axis_increment=null,this.stacked=null,this._9=null},set_margins:function(t){this.top_margin=this.left_margin=this.right_margin=this.bottom_margin=t},set_font:function(t){this.font=t,this._0.font=this.font},add_color:function(t){this.colors.push(t)},replace_colors:function(t){this.colors=t||[],this._w=0},set_theme:function(t){this._1j(),this._k={colors:["black","white"],additional_line_colors:[],marker_color:"white",font_color:"black",background_colors:null,background_image:null};for(var i in t)this._k[i]=t[i];this.colors=this._k.colors,this.marker_color=this._k.marker_color,this.font_color=this._k.font_color||this.marker_color,this._1C=this._k.additional_line_colors,this._M()},set_background:function(t){t.colors&&(this._k.background_colors=t.colors),t.image&&(this._k.background_image=t.image),this._M()},theme_keynote:function(){this._11="#6886B4",this._12="#FDD84E",this._v="#72AE6E",this._D="#D1695E",this._13="#8A6EAF",this._E="#EFAA43",this._F="white",this.colors=[this._12,this._11,this._v,this._D,this._13,this._E,this._F],this.set_theme({colors:this.colors,marker_color:"white",font_color:"white",background_colors:["black","#4a465a"]})},theme_37signals:function(){this._v="#339933",this._13="#cc99cc",this._11="#336699",this._12="#FFF804",this._D="#ff0000",this._E="#cf5910",this._G="black",this.colors=[this._12,this._11,this._v,this._D,this._13,this._E,this._G],this.set_theme({colors:this.colors,marker_color:"black",font_color:"black",background_colors:["#d1edf5","white"]})},theme_rails_keynote:function(){this._v="#00ff00",this._14="#333333",this._E="#ff5d00",this._D="#f61100",this._F="white",this._15="#999999",this._G="black",this.colors=[this._v,this._14,this._E,this._D,this._F,this._15,this._G],this.set_theme({colors:this.colors,marker_color:"white",font_color:"white",background_colors:["#0083a3","#0083a3"]})},theme_odeo:function(){this._14="#202020",this._F="white",this._1D="#a21764",this._v="#8ab438",this._15="#999999",this._1E="#3a5b87",this._G="black",this.colors=[this._14,this._F,this._1E,this._1D,this._v,this._15,this._G],this.set_theme({colors:this.colors,marker_color:"white",font_color:"white",background_colors:["#ff47a4","#ff1f81"]})},theme_pastel:function(){this.colors=["#a9dada","#aedaa9","#daaea9","#dadaa9","#a9a9da","#daaeda","#dadada"],this.set_theme({colors:this.colors,marker_color:"#aea9a9",font_color:"black",background_colors:"white"})},theme_greyscale:function(){this.colors=["#282828","#383838","#686868","#989898","#c8c8c8","#e8e8e8"],this.set_theme({colors:this.colors,marker_color:"#aea9a9",font_color:"black",background_colors:"white"})},data:function(t,i,s){i=void 0===i?[]:i,s=s||null,i=Bluff.array(i),this._1.push([t,i,s||this._1F()]),this._5=i.length>this._5?i.length:this._5,Bluff.each(i,function(t){void 0!==t&&(null===this.maximum_value&&null===this.minimum_value&&(this.maximum_value=this.minimum_value=t),this.maximum_value=this._1k(t)?t:this.maximum_value,this.maximum_value>=0&&(this._c=!0),this.minimum_value=this._1G(t)?t:this.minimum_value,this.minimum_value<0&&(this._c=!0))},this)},draw:function(){this.stacked&&this._1H(),this._1I(),this._x(function(){this._0.rectangle(this.left_margin,this.top_margin,this._b-this.right_margin,this._L-this.bottom_margin),this._0.rectangle(this._2,this._7,this._l,this._g)})},clear:function(){this._M()},on:function(t,i,s){var h=this._10[t]=this._10[t]||[];h.push([i,s])},trigger:function(t,i){var s=this._10[t];s&&Bluff.each(s,function(t){t[0].call(t[1],i)})},_1I:function(){return this._c?(this._16(),this._1K(),this.sort&&this._1L(),this._1M(),this._N(),this._1N(),this._1O(),void 0):this._1J()},_16:function(t){if(null===this._9||t===!0){if(this._9=[],!this._c)return;this._1l(),Bluff.each(this._1,function(t){var i=[];Bluff.each(t[this.klass.DATA_VALUES_INDEX],function(t){null===t||void 0===t?i.push(null):i.push((t-this.minimum_value)/this._i)},this),this._9.push([t[this.klass.DATA_LABEL_INDEX],i,t[this.klass.DATA_COLOR_INDEX]])},this)}},_1l:function(){this._i=this.maximum_value-this.minimum_value,this._i=this._i>0?this._i:1;var t=Math.round(Math.LOG10E*Math.log(this._i));this._1m=Math.pow(10,3-t)},_1K:function(){this._O=this.hide_line_markers?0:this._P(this.marker_font_size),this._1n=this.hide_title?0:this._P(this.title_font_size),this._1o=this.hide_legend?0:this._P(this.legend_font_size);var t,i,s,h,_,e,n;if(this.hide_line_markers)this._2=this.left_margin,this._17=this.right_margin,this._1p=this.bottom_margin;else{if(i=0,this.has_left_labels){t="";for(n in this.labels)t=t.length>this.labels[n].length?t:this.labels[n];i=1.25*this._H(this.marker_font_size,t)}else i=this._H(this.marker_font_size,this._Q(this.maximum_value));s=this.hide_line_numbers&&!this.has_left_labels?0:i+2*this.klass.LABEL_MARGIN,this._2=this.left_margin+s+(null===this.y_axis_label?0:this._O+2*this.klass.LABEL_MARGIN),h=-1/0;for(n in this.labels)h=h>Number(n)?h:Number(n);h=Math.round(h),_=h>=this._5-1&&this.center_labels_over_point?this._H(this.marker_font_size,this.labels[h])/2:0,this._17=this.right_margin+_,this._1p=this.bottom_margin+this._O+this.klass.LABEL_MARGIN}this._l=this._b-this._17,this._6=this._b-this._2-this._17,this._7=this.top_margin+(this.hide_title?this.title_margin:this._1n+this.title_margin)+(this.hide_legend?this.legend_margin:this._1o+this.legend_margin),e=null===this.x_axis_label?0:this._O+this.klass.LABEL_MARGIN,this._g=this._L-this._1p-e,this._3=this._g-this._7},_1N:function(){if(this.x_axis_label){var t=this._g+2*this.klass.LABEL_MARGIN+this._O;this._0.fill=this.font_color,this.font&&(this._0.font=this.font),this._0.stroke="transparent",this._0.pointsize=this._d(this.marker_font_size),this._0.gravity="north",this._0.annotate_scaled(this._b,1,0,t,this.x_axis_label,this._a),this._x(function(){this._0.line(0,t,this._b,t)})}},_N:function(){if(!this.hide_line_markers){null===this.y_axis_increment?(null===this.marker_count&&(Bluff.each([3,4,5,6,7],function(t){this.marker_count||0!==this._i%t||(this.marker_count=t)},this),this.marker_count=this.marker_count||4),this._18=this._i>0?this._19(this._i/this.marker_count):1):(this.maximum_value=Math.max(Math.ceil(this.maximum_value),this.y_axis_increment),this.minimum_value=Math.floor(this.minimum_value),this._1l(),this._16(!0),this.marker_count=Math.round(this._i/this.y_axis_increment),this._18=this.y_axis_increment),this._1P=this._3/(this._i/this._18);var t,i,s,h;for(t=0,i=this.marker_count;i>=t;t++)s=this._7+this._3-t*this._1P,this._0.stroke=this.marker_color,this._0.stroke_width=1,this._0.line(this._2,s,this._l,s),h=t*this._18+this.minimum_value,this.hide_line_numbers||(this._0.fill=this.font_color,this.font&&(this._0.font=this.font),this._0.font_weight="normal",this._0.stroke="transparent",this._0.pointsize=this._d(this.marker_font_size),this._0.gravity="east",this._0.annotate_scaled(this._2-this.klass.LABEL_MARGIN,1,0,s,this._Q(h),this._a))}},_1q:function(t){return(this._b-t)/2},_1M:function(){if(!this.hide_legend){this._I=Bluff.map(this._1,function(t){return t[this.klass.DATA_LABEL_INDEX]},this);var t=this.legend_box_size;this.font&&(this._0.font=this.font),this._0.pointsize=this.legend_font_size;var i=[[]];Bluff.each(this._I,function(s){var h=i.length-1,_=this._0.get_type_metrics(s),e=_.width+2.7*t;i[h].push(e),Bluff.sum(i[h])>.9*this._b&&i.push([i[h].pop()])},this);var s=this._1q(Bluff.sum(i[0])),h=this.hide_title?this.top_margin+this.title_margin:this.top_margin+this.title_margin+this._1n;this._x(function(){this._0.stroke_width=1,this._0.line(0,h,this._b,h)}),Bluff.each(this._I,function(_,e){this._0.fill=this.font_color,this.font&&(this._0.font=this.font),this._0.pointsize=this._d(this.legend_font_size),this._0.stroke="transparent",this._0.font_weight="normal",this._0.gravity="west",this._0.annotate_scaled(this._b,1,s+1.7*t,h,_,this._a),this._0.stroke="transparent",this._0.fill=this._1[e][this.klass.DATA_COLOR_INDEX],this._0.rectangle(s,h-t/2,s+t,h+t/2),this._0.pointsize=this.legend_font_size;var n,a=this._0.get_type_metrics(_),l=a.width+2.7*t;i[0].shift(),0==i[0].length?(this._x(function(){this._0.line(0,h,this._b,h)}),i.shift(),i.length>0&&(s=this._1q(Bluff.sum(i[0]))),n=Math.max(this._1o,t)+this.legend_margin,i.length>0&&(h+=n,this._7+=n,this._3=this._g-this._7)):s+=l},this),this._w=0}},_1O:function(){!this.hide_title&&this.title&&(this._0.fill=this.font_color,this.font&&(this._0.font=this.font),this._0.pointsize=this._d(this.title_font_size),this._0.font_weight="bold",this._0.gravity="north",this._0.annotate_scaled(this._b,1,0,this.top_margin,this.title,this._a))},_e:function(t,i){if(!this.hide_line_markers){var s;this.labels[i]&&!this._u[i]&&(s=this._g+this.klass.LABEL_MARGIN,this._0.fill=this.font_color,this.font&&(this._0.font=this.font),this._0.stroke="transparent",this._0.font_weight="normal",this._0.pointsize=this._d(this.marker_font_size),this._0.gravity="north",this._0.annotate_scaled(1,1,t,s,this.labels[i],this._a),this._u[i]=!0,this._x(function(){this._0.stroke_width=1,this._0.line(0,s,this._b,s)}))}},_y:function(t,i,s,h,_,e,n,a){if(this.tooltips){var l=this._0.tooltip(t,i,s,h,_,e,n);Bluff.Event.observe(l,"click",function(){var t={series:_,label:this.labels[a],value:n,color:e};this.trigger("click:datapoint",t)},this)}},_1J:function(){this._0.fill=this.font_color,this.font&&(this._0.font=this.font),this._0.stroke="transparent",this._0.font_weight="normal",this._0.pointsize=this._d(80),this._0.gravity="center",this._0.annotate_scaled(this._b,this._L/2,0,10,this.no_data_message,this._a)},_M:function(){var t=this._k.background_colors;switch(!0){case t instanceof Array:this._1Q.apply(this,t);break;case"string"==typeof t:this._1R(t);break;default:this._1S(this._k.background_image)}},_1R:function(t){this._0.render_solid_background(this._j,this._t,t)},_1Q:function(t,i){this._0.render_gradiated_background(this._j,this._t,t,i)},_1S:function(){},_1j:function(){this._w=0,this._u={},this._k={},this._0.scale(this._a,this._a)},_2k:function(t){return this._a*t},_d:function(t){var i=t*this._a;return i},_R:function(t,i){return t>i?i:t},_1k:function(t){return t>this.maximum_value},_1G:function(t){return t<this.minimum_value},_1r:function(t){return t},_2l:function(t){return t},_19:function(t){if(0==t)return 1;for(var i=1;10>t;)t*=10,i/=10;for(;t>100;)t/=10,i*=10;return Math.floor(t)*i},_1L:function(){var t=this._1T,i=this.klass.DATA_VALUES_INDEX;this._9.sort(function(s,h){return t(h[i])-t(s[i])}),this._1.sort(function(s,h){return t(h[i])-t(s[i])})},_1T:function(t){var i=0;return Bluff.each(t,function(t){i+=t||0}),i},_1H:function(){for(var t=[],i=this._5;i--;)t[i]=0;Bluff.each(this._1,function(i){Bluff.each(i[this.klass.DATA_VALUES_INDEX],function(i,s){t[s]+=i},this),i[this.klass.DATA_VALUES_INDEX]=Bluff.array(t)},this)},_x:function(t){this.klass.DEBUG&&(this._0.fill="transparent",this._0.stroke="turquoise",t.call(this))},_1F:function(){var t=this._w;return this._w=(this._w+1)%this.colors.length,this.colors[t]},_Q:function(t){var i=this.klass.THOUSAND_SEPARATOR,s=0==this._i%this.marker_count||null!==this.y_axis_increment?String(Math.round(t)):String(Math.floor(t*this._1m)/this._1m),h=s.split(".");return h[0]=h[0].replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1"+i),h.join(".")},_P:function(t){return this._0.caps_height(t)},_H:function(t,i){return this._0.text_width(t,i)}}),Bluff.Area=new JS.Class(Bluff.Base,{draw:function(){this.callSuper(),this._c&&(this._S=this._6/(this._5-1),this._0.stroke="transparent",Bluff.each(this._9,function(t){var i=[],s=0,h=0;Bluff.each(t[this.klass.DATA_VALUES_INDEX],function(t,_){var e=this._2+this._S*_,n=this._7+(this._3-t*this._3);s>0&&h>0?(i.push(e),i.push(n)):(i.push(this._2),i.push(this._g-1),i.push(e),i.push(n)),this._e(e,_),s=e,h=n},this),i.push(this._l),i.push(this._g-1),i.push(this._2),i.push(this._g-1),this._0.fill=t[this.klass.DATA_COLOR_INDEX],this._0.polyline(i)},this))}}),Bluff.BarConversion=new JS.Class({mode:null,zero:null,graph_top:null,graph_height:null,minimum_value:null,spread:null,getLeftYRightYscaled:function(t,i){var s;switch(this.mode){case 1:i[0]=this.graph_top+this.graph_height*(1-t)+1,i[1]=this.graph_top+this.graph_height-1;break;case 2:i[0]=this.graph_top+1,i[1]=this.graph_top+this.graph_height*(1-t)-1;break;case 3:s=t-this.minimum_value/this.spread,t>=this.zero?(i[0]=this.graph_top+this.graph_height*(1-(s-this.zero))+1,i[1]=this.graph_top+this.graph_height*(1-this.zero)-1):(i[0]=this.graph_top+this.graph_height*(1-(s-this.zero))+1,i[1]=this.graph_top+this.graph_height*(1-this.zero)-1);break;default:i[0]=0,i[1]=0}}}),Bluff.Bar=new JS.Class(Bluff.Base,{bar_spacing:.9,draw:function(){this.center_labels_over_point=Bluff.keys(this.labels).length>this._5,this.callSuper(),this._c&&this._T()},_T:function(){this._8=this._6/(this._5*this._1.length);var t=this._8*(1-this.bar_spacing)/2;this._0.stroke_opacity=0;var i=new Bluff.BarConversion;i.graph_height=this._3,i.graph_top=this._7,this.minimum_value>=0?i.mode=1:this.maximum_value<=0?i.mode=2:(i.mode=3,i.spread=this._i,i.minimum_value=this.minimum_value,i.zero=-this.minimum_value/this._i),Bluff.each(this._9,function(s,h){var _=this._1[h][this.klass.DATA_VALUES_INDEX];Bluff.each(s[this.klass.DATA_VALUES_INDEX],function(e,n){var a=this._2+this._8*(h+n+(this._1.length-1)*n)+t,l=a+this._8*this.bar_spacing,r=[];i.getLeftYRightYscaled(e,r),this._0.fill=s[this.klass.DATA_COLOR_INDEX],this._0.rectangle(a,r[0],l,r[1]),this._y(a,r[0],l-a,r[1]-r[0],s[this.klass.DATA_LABEL_INDEX],s[this.klass.DATA_COLOR_INDEX],_[n],n);var o=this._2+this._1.length*this._8*n+this._1.length*this._8/2;this._e(o-(this.center_labels_over_point?this._8/2:0),n)},this)},this),this.center_labels_over_point&&this._e(this._l,this._5)}}),Bluff.Line=new JS.Class(Bluff.Base,{baseline_value:null,baseline_color:null,line_width:null,dot_radius:null,hide_dots:null,hide_lines:null,initialize:function(t){if(arguments.length>3)throw"Wrong number of arguments";1===arguments.length||"number"!=typeof arguments[1]&&"string"!=typeof arguments[1]?this.callSuper(t,null):this.callSuper(),this.hide_dots=this.hide_lines=!1,this.baseline_color="red",this.baseline_value=null},draw:function(){if(this.callSuper(),this._c){this.x_increment=this._5>1?this._6/(this._5-1):this._6;var t;void 0!==this._U&&(t=this._7+(this._3-this._U*this._3),this._0.push(),this._0.stroke=this.baseline_color,this._0.fill_opacity=0,this._0.stroke_width=3,this._0.line(this._2,t,this._2+this._6,t),this._0.pop()),Bluff.each(this._9,function(t,i){var s=null,h=null,_=this._1[i][this.klass.DATA_VALUES_INDEX];this._1U=this._1V(t),Bluff.each(t[this.klass.DATA_VALUES_INDEX],function(i,e){var n=this._2+this.x_increment*e;if("number"==typeof i){this._e(n,e);var a=this._7+(this._3-i*this._3);this._0.stroke=t[this.klass.DATA_COLOR_INDEX],this._0.fill=t[this.klass.DATA_COLOR_INDEX],this._0.stroke_opacity=1,this._0.stroke_width=this.line_width||this._R(this._j/(6*this._9[0][this.klass.DATA_VALUES_INDEX].length),3);var l=this.dot_radius||this._R(this._j/(2*this._9[0][this.klass.DATA_VALUES_INDEX].length),7);this.hide_lines||null===s||null===h?this._1U&&this._0.circle(n,a,n-l,a):this._0.line(s,h,n,a),this.hide_dots||this._0.circle(n,a,n-l,a),this._y(n-l,a-l,2*l,2*l,t[this.klass.DATA_LABEL_INDEX],t[this.klass.DATA_COLOR_INDEX],_[e],e),s=n,h=a}},this)},this)}},_16:function(){this.maximum_value=Math.max(this.maximum_value,this.baseline_value),this.callSuper(),null!==this.baseline_value&&(this._U=this.baseline_value/this.maximum_value)},_1V:function(t){var i=0;return Bluff.each(t[this.klass.DATA_VALUES_INDEX],function(t){void 0!==t&&(i+=1)}),1===i}}),Bluff.Dot=new JS.Class(Bluff.Base,{draw:function(){if(this.has_left_labels=!0,this.callSuper(),this._c){var t=1;this._J=this._3/this._5,this._1a=this._J*t/this._9.length,this._0.stroke_opacity=0;var i=(Bluff.array_new(this._5,0),Bluff.array_new(this._5,this._2),this._J*(1-t)/2);Bluff.each(this._9,function(t,s){Bluff.each(t[this.klass.DATA_VALUES_INDEX],function(h,_){var e=this._2+h*this._6-Math.round(this._1a/6),n=this._7+this._J*_+i+Math.round(this._1a/2);0===s&&(this._0.stroke=this.marker_color,this._0.stroke_width=1,this._0.opacity=.1,this._0.line(this._2,n,this._2+this._6,n)),this._0.fill=t[this.klass.DATA_COLOR_INDEX],this._0.stroke="transparent",this._0.circle(e,n,e+Math.round(this._1a/3),n);var a=this._7+(this._J*_+this._J/2)+i;this._e(a,_)},this)},this)}},_N:function(){if(!this.hide_line_markers){this._0.stroke_antialias=!1,this._0.stroke_width=1;for(var t=5,i=this._19(this.maximum_value/t),s=0;t>=s;s++){var h=(this._l-this._2)/t,_=this._l-h*s-1,e=s-t,n=Math.abs(e)*i;this._0.stroke=this.marker_color,this._0.line(_,this._g,_,this._g+.5*this.klass.LABEL_MARGIN),this.hide_line_numbers||(this._0.fill=this.font_color,this.font&&(this._0.font=this.font),this._0.stroke="transparent",this._0.pointsize=this._d(this.marker_font_size),this._0.gravity="center",this._0.annotate_scaled(0,0,_,this._g+2*this.klass.LABEL_MARGIN,n,this._a)),this._0.stroke_antialias=!0}}},_e:function(t,i){this.labels[i]&&!this._u[i]&&(this._0.fill=this.font_color,this.font&&(this._0.font=this.font),this._0.stroke="transparent",this._0.font_weight="normal",this._0.pointsize=this._d(this.marker_font_size),this._0.gravity="east",this._0.annotate_scaled(1,1,this._2-2*this.klass.LABEL_MARGIN,t,this.labels[i],this._a),this._u[i]=!0)}}),Bluff.Net=new JS.Class(Bluff.Base,{hide_dots:null,line_width:null,dot_radius:null,initialize:function(){this.callSuper(),this.hide_dots=!1,this.hide_line_numbers=!0},draw:function(){if(this.callSuper(),this._c){this._z=this._3/2,this._A=this._2+this._6/2,this._B=this._7+this._3/2-10,this._S=this._6/(this._5-1);var t=this.dot_radius||this._R(this._j/(2.5*this._9[0][this.klass.DATA_VALUES_INDEX].length),7);this._0.stroke_opacity=1,this._0.stroke_width=this.line_width||this._R(this._j/(4*this._9[0][this.klass.DATA_VALUES_INDEX].length),3);var i;void 0!==this._U&&(i=this._7+(this._3-this._U*this._3),this._0.push(),this._0.stroke_color=this.baseline_color,this._0.fill_opacity=0,this._0.stroke_width=5,this._0.line(this._2,i,this._2+this._6,i),this._0.pop()),Bluff.each(this._9,function(i){Bluff.each(i[this.klass.DATA_VALUES_INDEX],function(s,h){if(void 0!==s){var _=2*h*Math.PI/this._5,e=s*this._z,n=this._A+Math.sin(_)*e,a=this._B-Math.cos(_)*e,l=h+1<i[this.klass.DATA_VALUES_INDEX].length?h+1:0,r=2*l*Math.PI/this._5,o=i[this.klass.DATA_VALUES_INDEX][l]*this._z,f=this._A+Math.sin(r)*o,u=this._B-Math.cos(r)*o;this._0.stroke=i[this.klass.DATA_COLOR_INDEX],this._0.fill=i[this.klass.DATA_COLOR_INDEX],this._0.line(n,a,f,u),this.hide_dots||this._0.circle(n,a,n-t,a)}},this)},this)}},_N:function(){if(!this.hide_line_markers){this._z=this._3/2,this._A=this._2+this._6/2,this._B=this._7+this._3/2-10;for(var t,i,s=0,h=this._5;h>s;s++)t=2*s*Math.PI/this._5,this._0.stroke=this.marker_color,this._0.stroke_width=1,this._0.line(this._A,this._B,this._A+Math.sin(t)*this._z,this._B-Math.cos(t)*this._z),i=this.labels[s]?this.labels[s]:"000",this._e(this._A,this._B,360*t/(2*Math.PI),this._z,i)}},_e:function(t,i,s,h,_){var e=1.1,n=t,a=i,l=s*Math.PI/180,r=n+h*e*Math.sin(l),o=a-h*e*Math.cos(l);this._0.fill=this.marker_color,this.font&&(this._0.font=this.font),this._0.pointsize=this._d(20),this._0.stroke="transparent",this._0.font_weight="bold",this._0.gravity="center",this._0.annotate_scaled(0,0,r,o,_,this._a)}}),Bluff.Pie=new JS.Class(Bluff.Base,{extend:{TEXT_OFFSET_PERCENTAGE:.08},zero_degreee:null,hide_labels_less_than:null,initialize_ivars:function(){this.callSuper(),this.zero_degree=0,this.hide_labels_less_than=0},draw:function(){if(this.hide_line_markers=!0,this.callSuper(),this._c){var t=this._3,i=.8*(Math.min(this._6,this._3)/2),s=(this._2+(this._6-t)/2,this._2+this._6/2),h=this._7+this._3/2-10,_=this._1W(),e=this.zero_degree,n=this.klass.DATA_VALUES_INDEX;this.sort&&this._1.sort(function(t,i){return t[n][0]-i[n][0]}),Bluff.each(this._1,function(t,n){if(t[this.klass.DATA_VALUES_INDEX][0]>0){this._0.fill=t[this.klass.DATA_COLOR_INDEX];var a=360*(t[this.klass.DATA_VALUES_INDEX][0]/_);this._0.circle(s,h,s+i,h,e,e+a+.5);var l,r=e+(e+a-e)/2,o=Math.round(100*(t[this.klass.DATA_VALUES_INDEX][0]/_));o>=this.hide_labels_less_than&&(l=this._Q(t[this.klass.DATA_VALUES_INDEX][0]),this._e(s,h,r,i+i*this.klass.TEXT_OFFSET_PERCENTAGE,l,t,n)),e+=a}},this)}},_e:function(t,i,s,h,_,e,n){var a=20,l=t,r=i,o=h+a,f=.15*o,u=l+(o+f)*Math.cos(s*Math.PI/180),c=r+o*Math.sin(s*Math.PI/180);this._0.fill=this.font_color,this.font&&(this._0.font=this.font),this._0.pointsize=this._d(this.marker_font_size),this._0.font_weight="bold",this._0.gravity="center",this._0.annotate_scaled(0,0,u,c,_,this._a),this._y(u-20,c-20,40,40,e[this.klass.DATA_LABEL_INDEX],e[this.klass.DATA_COLOR_INDEX],_,n)},_1W:function(){var t=0;return Bluff.each(this._1,function(i){t+=i[this.klass.DATA_VALUES_INDEX][0]},this),t}}),Bluff.SideBar=new JS.Class(Bluff.Base,{bar_spacing:.9,draw:function(){this.has_left_labels=!0,this.callSuper(),this._c&&this._T()},_T:function(){this._V=this._3/this._5,this._8=this._V/this._9.length,this._0.stroke_opacity=0;var t=Bluff.array_new(this._5,0),i=Bluff.array_new(this._5,this._2),s=this._8*(1-this.bar_spacing)/2;Bluff.each(this._9,function(h,_){var e=this._1[_][this.klass.DATA_VALUES_INDEX];Bluff.each(h[this.klass.DATA_VALUES_INDEX],function(n,a){var l=this._2+(this._6-n*this._6-t[a]),r=this._2+this._6-t[a],o=r-l,f=i[a]-1,u=this._7+this._V*a+this._8*_+s,c=f+o,d=u+this._8*this.bar_spacing;t[a]+=n*this._6,this._0.stroke="transparent",this._0.fill=h[this.klass.DATA_COLOR_INDEX],this._0.rectangle(f,u,c,d),this._y(f,u,c-f,d-u,h[this.klass.DATA_LABEL_INDEX],h[this.klass.DATA_COLOR_INDEX],e[a],a);var m=this._7+(this._V*a+this._V/2);this._e(m,a)},this)},this)},_N:function(){if(!this.hide_line_markers){this._0.stroke_antialias=!1,this._0.stroke_width=1;for(var t,i,s,h,_=5,e=this._19(this._i/_),n=0;_>=n;n++)t=(this._l-this._2)/_,i=this._l-t*n-1,s=n-_,h=Math.abs(s)*e+this.minimum_value,this._0.stroke=this.marker_color,this._0.line(i,this._g,i,this._7),this.hide_line_numbers||(this._0.fill=this.font_color,this.font&&(this._0.font=this.font),this._0.stroke="transparent",this._0.pointsize=this._d(this.marker_font_size),this._0.gravity="center",this._0.annotate_scaled(0,0,i,this._g+2*this.klass.LABEL_MARGIN,this._Q(h),this._a))}},_e:function(t,i){this.labels[i]&&!this._u[i]&&(this._0.fill=this.font_color,this.font&&(this._0.font=this.font),this._0.stroke="transparent",this._0.font_weight="normal",this._0.pointsize=this._d(this.marker_font_size),this._0.gravity="east",this._0.annotate_scaled(1,1,this._2-2*this.klass.LABEL_MARGIN,t,this.labels[i],this._a),this._u[i]=!0)}}),Bluff.Spider=new JS.Class(Bluff.Base,{hide_text:null,hide_axes:null,transparent_background:null,initialize:function(t,i,s){this.callSuper(t,s),this._1X=i,this.hide_legend=!0},draw:function(){if(this.hide_line_markers=!0,this.callSuper(),this._c){var t=this._3,i=this._3/2,s=(this._2+(this._6-t)/2,this._2+this._6/2),h=this._7+this._3/2-25;this._1Y=i/this._1X;var _=(this._1Z(),2*Math.PI/this._1.length);this.hide_axes||this._20(s,h,i,_),this._21(s,h,_)}},_1s:function(t){return t*this._1Y},_e:function(t,i,s,h,_){var e=50,n=t,a=i+0,l=n+(h+e)*Math.cos(s),r=a+(h+e)*Math.sin(s);this._0.fill=this.marker_color,this.font&&(this._0.font=this.font),this._0.pointsize=this._d(this.legend_font_size),this._0.stroke="transparent",this._0.font_weight="bold",this._0.gravity="center",this._0.annotate_scaled(0,0,l,r,_,this._a)},_20:function(t,i,s,h,_){if(!this.hide_axes){var e=0;Bluff.each(this._1,function(n){this._0.stroke=_||n[this.klass.DATA_COLOR_INDEX],this._0.stroke_width=5;var a=s*Math.cos(e),l=s*Math.sin(e);this._0.line(t,i,t+a,i+l),this.hide_text||this._e(t,i,e,s,n[this.klass.DATA_LABEL_INDEX]),e+=h},this)}},_21:function(t,i,s,h){var _=[],e=0;Bluff.each(this._1,function(h){_.push(t+this._1s(h[this.klass.DATA_VALUES_INDEX][0])*Math.cos(e)),_.push(i+this._1s(h[this.klass.DATA_VALUES_INDEX][0])*Math.sin(e)),e+=s},this),this._0.stroke_width=1,this._0.stroke=h||this.marker_color,this._0.fill=h||this.marker_color,this._0.fill_opacity=.4,this._0.polyline(_)},_1Z:function(){var t=0;return Bluff.each(this._1,function(i){t+=i[this.klass.DATA_VALUES_INDEX][0]},this),t}}),Bluff.Base.StackedMixin=new JS.Module({_1b:function(){var t={};Bluff.each(this._1,function(i){Bluff.each(i[this.klass.DATA_VALUES_INDEX],function(i,s){t[s]||(t[s]=0),t[s]+=i},this)},this);for(var i in t)t[i]>this.maximum_value&&(this.maximum_value=t[i]);this.minimum_value=0}}),Bluff.StackedArea=new JS.Class(Bluff.Base,{include:Bluff.Base.StackedMixin,last_series_goes_on_bottom:null,draw:function(){if(this._1b(),this.callSuper(),this._c){this._S=this._6/(this._5-1),this._0.stroke="transparent";var t=Bluff.array_new(this._5,0),i=null,s=this.last_series_goes_on_bottom?"reverse_each":"each";Bluff[s](this._9,function(s){var h=i;i=[],Bluff.each(s[this.klass.DATA_VALUES_INDEX],function(s,h){var _=this._2+this._S*h,e=this._7+(this._3-s*this._3-t[h]);t[h]+=s*this._3,i.push(_),i.push(e),this._e(_,h)},this);var _,e;if(h){for(_=Bluff.array(i),e=h.length/2-1;e>=0;e--)_.push(h[2*e]),_.push(h[2*e+1]);_.push(i[0]),_.push(i[1])}else _=Bluff.array(i),_.push(this._l),_.push(this._g-1),_.push(this._2),_.push(this._g-1),_.push(i[0]),_.push(i[1]);this._0.fill=s[this.klass.DATA_COLOR_INDEX],this._0.polyline(_)},this)}}}),Bluff.StackedBar=new JS.Class(Bluff.Base,{include:Bluff.Base.StackedMixin,bar_spacing:.9,draw:function(){if(this._1b(),this.callSuper(),this._c){this._8=this._6/this._5;var t=this._8*(1-this.bar_spacing)/2;this._0.stroke_opacity=0;var i=Bluff.array_new(this._5,0);Bluff.each(this._9,function(s,h){var _=this._1[h][this.klass.DATA_VALUES_INDEX];Bluff.each(s[this.klass.DATA_VALUES_INDEX],function(h,e){var n=this._2+this._8*e+this._8*this.bar_spacing/2;if(this._e(n,e),0!=h){var a=this._2+this._8*e+t,l=this._7+(this._3-h*this._3-i[e])+1,r=a+this._8*this.bar_spacing,o=this._7+this._3-i[e]-1;i[e]+=h*this._3,this._0.fill=s[this.klass.DATA_COLOR_INDEX],this._0.rectangle(a,l,r,o),this._y(a,l,r-a,o-l,s[this.klass.DATA_LABEL_INDEX],s[this.klass.DATA_COLOR_INDEX],_[e],e)}},this)},this)}}}),Bluff.AccumulatorBar=new JS.Class(Bluff.StackedBar,{draw:function(){if(1!==this._1.length)throw"Incorrect number of datasets";var t=[],i=0,s=[];Bluff.each(this._1[0][this.klass.DATA_VALUES_INDEX],function(h){var _=-1/0;Bluff.each(s,function(t){_=Math.max(_,t)}),s.push(i>0?h+_:h),t.push(s[i]-h),i+=1},this),this.data("Accumulator",t),this.callSuper()}}),Bluff.SideStackedBar=new JS.Class(Bluff.SideBar,{include:Bluff.Base.StackedMixin,bar_spacing:.9,draw:function(){this.has_left_labels=!0,this._1b(),this.callSuper()},_T:function(){this._8=this._3/this._5;var t=Bluff.array_new(this._5,0),i=Bluff.array_new(this._5,this._2),s=this._8*(1-this.bar_spacing)/2;Bluff.each(this._9,function(h,_){var e=this._1[_][this.klass.DATA_VALUES_INDEX];Bluff.each(h[this.klass.DATA_VALUES_INDEX],function(_,n){var a=this._2+(this._6-_*this._6-t[n])+1,l=this._2+this._6-t[n]-1,r=l-a;this._0.fill=h[this.klass.DATA_COLOR_INDEX];var o=i[n],f=this._7+this._8*n+s,u=o+r,c=f+this._8*this.bar_spacing;i[n]+=r,t[n]+=_*this._6-2,this._0.rectangle(o,f,u,c),this._y(o,f,u-o,c-f,h[this.klass.DATA_LABEL_INDEX],h[this.klass.DATA_COLOR_INDEX],e[n],n);var d=this._7+this._8*n+this._8*this.bar_spacing/2;this._e(d,n)},this)},this)},_1k:function(t,i){return i=i||0,this._1r(t,i)>this.maximum_value},_1r:function(t,i){var s=0;return Bluff.each(this._1,function(t){s+=t[this.klass.DATA_VALUES_INDEX][i]},this),s}}),Bluff.Mini.Legend=new JS.Module({hide_mini_legend:!1,_1c:function(){if(!this.hide_mini_legend){this._I=Bluff.map(this._1,function(t){return t[this.klass.DATA_LABEL_INDEX]},this);var t=this._d(this._1.length*this._1t()+this.top_margin+this.bottom_margin);switch(this._22=this._L,this._23=this._b,this.legend_position){case"right":this._t=Math.max(this._t,t),this._j+=this._24()+this.left_margin;break;default:this._t+=t}this._M()}},_1t:function(){return 1.7*this._P(this.legend_font_size)},_24:function(){var t=0;return Bluff.each(this._I,function(i){t=Math.max(this._H(this.legend_font_size,i),t)},this),this._d(t+68)},_1d:function(){if(!this.hide_mini_legend){var t=40,i=100,s=40;this.font&&(this._0.font=this.font),this._0.pointsize=this.legend_font_size;var h,_;switch(this.legend_position){case"right":h=this._23+this.left_margin,_=this.top_margin+s;break;default:h=i,_=this._22+s}this._x(function(){this._0.line(0,_,this._b,_)}),Bluff.each(this._I,function(i,s){this._0.fill=this.font_color,this.font&&(this._0.font=this.font),this._0.pointsize=this._d(this.legend_font_size),this._0.stroke="transparent",this._0.font_weight="normal",this._0.gravity="west",this._0.annotate_scaled(this._b,1,h+1.7*t,_,this._25(i),this._a),this._0.stroke="transparent",this._0.fill=this._1[s][this.klass.DATA_COLOR_INDEX],this._0.rectangle(h,_-t/2,h+t,_+t/2),_+=this._1t()},this),this._w=0}},_25:function(t){for(var i=String(t);this._H(this._d(this.legend_font_size),i)>this._j-this.legend_left_margin-this.right_margin&&i.length>1;)i=i.substr(0,i.length-1);return i+(i.length<String(t).length?"...":"")}}),Bluff.Mini.Bar=new JS.Class(Bluff.Bar,{include:Bluff.Mini.Legend,initialize_ivars:function(){this.callSuper(),this.hide_legend=!0,this.hide_title=!0,this.hide_line_numbers=!0,this.marker_font_size=50,this.minimum_value=0,this.maximum_value=0,this.legend_font_size=60},draw:function(){this._1c(),this.callSuper(),this._1d()}}),Bluff.Mini.Pie=new JS.Class(Bluff.Pie,{include:Bluff.Mini.Legend,initialize_ivars:function(){this.callSuper(),this.hide_legend=!0,this.hide_title=!0,this.hide_line_numbers=!0,this.marker_font_size=60,this.legend_font_size=60},draw:function(){this._1c(),this.callSuper(),this._1d()}}),Bluff.Mini.SideBar=new JS.Class(Bluff.SideBar,{include:Bluff.Mini.Legend,initialize_ivars:function(){this.callSuper(),this.hide_legend=!0,this.hide_title=!0,this.hide_line_numbers=!0,this.marker_font_size=50,this.legend_font_size=50},draw:function(){this._1c(),this.callSuper(),this._1d()}}),Bluff.Renderer=new JS.Class({extend:{WRAPPER_CLASS:"bluff-wrapper",TEXT_CLASS:"bluff-text",TARGET_CLASS:"bluff-tooltip-target"},font:"Arial, Helvetica, Verdana, sans-serif",gravity:"north",initialize:function(t){this._n=document.getElementById(t),this._4=this._n.getContext("2d")},scale:function(t,i){this._f=t,this._h=i||t
},caps_height:function(t){var i=this._W(t,"X"),s=this._K(i).height;return this._X(i),s},text_width:function(t,i){var s=this._W(t,i),h=this._K(s).width;return this._X(s),h},get_type_metrics:function(t){var i=this._W(this.pointsize,t);document.body.appendChild(i);var s=this._K(i);return this._X(i),s},clear:function(t,i){this._n.width=t,this._n.height=i,this._4.clearRect(0,0,t,i);var s=this._1u(),h=s.childNodes,_=h.length;for(s.style.width=t+"px",s.style.height=i+"px";_--;)"canvas"!==h[_].tagName.toLowerCase()&&(Bluff.Event.stopObserving(h[_]),this._X(h[_]))},push:function(){this._4.save()},pop:function(){this._4.restore()},render_gradiated_background:function(t,i,s,h){this.clear(t,i);var _=this._4.createLinearGradient(0,0,0,i);_.addColorStop(0,s),_.addColorStop(1,h),this._4.fillStyle=_,this._4.fillRect(0,0,t,i)},render_solid_background:function(t,i,s){this.clear(t,i),this._4.fillStyle=s,this._4.fillRect(0,0,t,i)},annotate_scaled:function(t,i,s,h,_,e){var n=t*e>=1?t*e:1,a=i*e>=1?i*e:1,_=this._W(this.pointsize,_);_.style.color=this.fill,_.style.cursor="default",_.style.fontWeight=this.font_weight,_.style.textAlign="center",_.style.left=this._f*s+this._26(_,n)+"px",_.style.top=this._h*h+this._27(_,a)+"px"},tooltip:function(t,i,s,h,_,e,n){0>s&&(t+=s),0>h&&(i+=h);var a=this._n.parentNode,l=document.createElement("div");return l.className=this.klass.TARGET_CLASS,l.style.cursor="default",l.style.position="absolute",l.style.left=this._f*t-3+"px",l.style.top=this._h*i-3+"px",l.style.width=this._f*Math.abs(s)+5+"px",l.style.height=this._h*Math.abs(h)+5+"px",l.style.fontSize=0,l.style.overflow="hidden",Bluff.Event.observe(l,"mouseover",function(){Bluff.Tooltip.show(_,e,n)}),Bluff.Event.observe(l,"mouseout",function(){Bluff.Tooltip.hide()}),a.appendChild(l),l},circle:function(t,i,s,h,_,e){var n=Math.sqrt(Math.pow(s-t,2)+Math.pow(h-i,2)),a=0,l=2*Math.PI;this._4.fillStyle=this.fill,this._4.beginPath(),void 0!==_&&void 0!==e&&360!==Math.abs(Math.floor(e-_))&&(a=_*Math.PI/180,l=e*Math.PI/180,this._4.moveTo(this._f*(t+n*Math.cos(l)),this._h*(i+n*Math.sin(l))),this._4.lineTo(this._f*t,this._h*i),this._4.lineTo(this._f*(t+n*Math.cos(a)),this._h*(i+n*Math.sin(a)))),this._4.arc(this._f*t,this._h*i,this._f*n,a,l,!1),this._4.fill()},line:function(t,i,s,h){this._4.strokeStyle=this.stroke,this._4.lineWidth=this.stroke_width,this._4.beginPath(),this._4.moveTo(this._f*t,this._h*i),this._4.lineTo(this._f*s,this._h*h),this._4.stroke()},polyline:function(t){this._4.fillStyle=this.fill,this._4.globalAlpha=this.fill_opacity||1;try{this._4.strokeStyle=this.stroke}catch(i){}var s=t.shift(),h=t.shift();for(this._4.beginPath(),this._4.moveTo(this._f*s,this._h*h);t.length>0;)s=t.shift(),h=t.shift(),this._4.lineTo(this._f*s,this._h*h);this._4.fill()},rectangle:function(t,i,s,h){var _;t>s&&(_=t,t=s,s=_),i>h&&(_=i,i=h,h=_);try{this._4.fillStyle=this.fill,this._4.fillRect(this._f*t,this._h*i,this._f*(s-t),this._h*(h-i))}catch(e){}try{this._4.strokeStyle=this.stroke,"transparent"!==this.stroke&&this._4.strokeRect(this._f*t,this._h*i,this._f*(s-t),this._h*(h-i))}catch(e){}},_26:function(t,i){var s=this._K(t).width;switch(this.gravity){case"west":return 0;case"east":return i-s;case"north":case"south":case"center":return(i-s)/2}},_27:function(t,i){var s=this._K(t).height;switch(this.gravity){case"north":return 0;case"south":return i-s;case"west":case"east":case"center":return(i-s)/2}},_1u:function(){var t=this._n.parentNode;return t.className===this.klass.WRAPPER_CLASS?t:(t=document.createElement("div"),t.className=this.klass.WRAPPER_CLASS,t.style.position="relative",t.style.border="none",t.style.padding="0 0 0 0",this._n.parentNode.insertBefore(t,this._n),t.appendChild(this._n),t)},_W:function(t,i){var s=this._28(i);return s.style.fontFamily=this.font,s.style.fontSize="number"==typeof t?t+"px":t,s},_28:function(t){var i=document.createElement("div");return i.className=this.klass.TEXT_CLASS,i.style.position="absolute",i.appendChild(document.createTextNode(t)),this._1u().appendChild(i),i},_X:function(t){t.parentNode.removeChild(t),t.className===this.klass.TARGET_CLASS&&Bluff.Event.stopObserving(t)},_K:function(t){var i=t.style.display;return i&&"none"!==i?{width:t.offsetWidth,height:t.offsetHeight}:{width:t.clientWidth,height:t.clientHeight}}}),Bluff.Event={_Y:[],_1v:window.attachEvent&&-1===navigator.userAgent.indexOf("Opera"),observe:function(t,i,s,h){var _=Bluff.map(this._1w(t,i),function(t){return t._29});if(-1===Bluff.index(_,s)){var e=function(i){s.call(h||null,t,Bluff.Event._2a(i))};this._Y.push({_Z:t,_1e:i,_29:s,_1x:e}),t.addEventListener?t.addEventListener(i,e,!1):t.attachEvent("on"+i,e)}},stopObserving:function(t){var i=t?this._1w(t):this._Y;Bluff.each(i,function(t){t._Z.removeEventListener?t._Z.removeEventListener(t._1e,t._1x,!1):t._Z.detachEvent("on"+t._1e,t._1x)})},_1w:function(t,i){var s=[];return Bluff.each(this._Y,function(h){t&&h._Z!==t||i&&h._1e!==i||s.push(h)}),s},_2a:function(t){if(!this._1v)return t;if(!t)return!1;if(t._2b)return t;t._2b=!0;var i=this._2c(t);return t.target=t.srcElement,t.pageX=i.x,t.pageY=i.y,t},_2c:function(t){var i=document.documentElement,s=document.body||{scrollLeft:0,scrollTop:0};return{x:t.pageX||t.clientX+(i.scrollLeft||s.scrollLeft)-(i.clientLeft||0),y:t.pageY||t.clientY+(i.scrollTop||s.scrollTop)-(i.clientTop||0)}}},Bluff.Event._1v&&window.attachEvent("onunload",function(){Bluff.Event.stopObserving(),Bluff.Event._Y=null}),navigator.userAgent.indexOf("AppleWebKit/")>-1&&window.addEventListener("unload",function(){},!1),Bluff.Tooltip=new JS.Singleton({LEFT_OFFSET:20,TOP_OFFSET:-6,DATA_LENGTH:8,CLASS_NAME:"bluff-tooltip",setup:function(){this._o=document.createElement("div"),this._o.className=this.CLASS_NAME,this._o.style.position="absolute",this.hide(),document.body.appendChild(this._o),Bluff.Event.observe(document.body,"mousemove",function(t,i){this._o.style.left=i.pageX+this.LEFT_OFFSET+"px",this._o.style.top=i.pageY+this.TOP_OFFSET+"px"},this)},show:function(t,i,s){s=Number(String(s).substr(0,this.DATA_LENGTH)),this._o.innerHTML='<span class="color" style="background: '+i+';">&nbsp;</span> <span class="label">'+t+'</span> <span class="data">'+s+"</span>",this._o.style.display=""},hide:function(){this._o.style.display="none"}}),Bluff.Event.observe(window,"load",Bluff.Tooltip.method("setup")),Bluff.TableReader=new JS.Class({NUMBER_FORMAT:/\-?(0|[1-9]\d*)(\.\d+)?(e[\+\-]?\d+)?/i,initialize:function(t,i){this._1f=i||{},this._2d=this._1f.orientation||"auto",this._2e="string"==typeof t?document.getElementById(t):t},get_data:function(){return this._1||this._1y(),this._1},get_labels:function(){return this._1g||this._1y(),this._1g},get_title:function(){return this._2f},get_series:function(t){return this._1[t]?this._1[t]:this._1[t]={points:[]}},_1y:function(){this._C=this._m=0,this._p=this._q=0,this._1=[],this._1g={},this._r=[],this._s=[],this._1h=[],this._1i=[],this._1z(this._2e),this._2g(),this._2h(),Bluff.each(this._s,function(t,i){this.get_series(i-this._q).name=t},this),Bluff.each(this._r,function(t,i){this._1g[i-this._p]=t},this)},_1z:function(t){this._2i(t);var i,s=t.childNodes,h=s.length;for(i=0;h>i;i++)this._1z(s[i])},_2i:function(t){if(t.tagName){var i,s,h=this._1A(t.innerHTML);switch(t.tagName.toUpperCase()){case"TR":this._c||(this._p=this._C),this._C+=1,this._m=0;break;case"TD":this._c||(this._q=this._m),this._c=!0,this._m+=1,h=h.match(this.NUMBER_FORMAT),null===h?this.get_series(i).points[s]=null:(i=this._m-this._q-1,s=this._C-this._p-1,this.get_series(i).points[s]=parseFloat(h[0]));break;case"TH":this._m+=1,this._2j(t)&&(this._1i.push(this._m),this._1h.push(this._C)),1===this._m&&1===this._C?this._r[0]=this._s[0]=h:"row"===t.scope||1===this._m?this._r[this._C-1]=h:this._s[this._m-1]=h;break;case"CAPTION":this._2f=h}}},_2j:function(t){if(!this._1f.except)return!1;var i=this._1A(t.innerHTML),s=(t.className||"").split(/\s+/),h=[].concat(this._1f.except);if(Bluff.index(h,i)>=0)return!0;for(var _=s.length;_--;)if(Bluff.index(h,s[_])>=0)return!0;return!1},_2g:function(){for(var t,i=this._1i.length;i--;)t=this._1i[i],t<=this._q||(this._s.splice(t-1,1),t>=this._q&&this._1.splice(t-1-this._q,1));for(var t,i=this._1h.length;i--;)t=this._1h[i],t<=this._p||(this._r.splice(t-1,1),Bluff.each(this._1,function(i){t>=this._p&&i.points.splice(t-1-this._p,1)},this))},_2h:function(){switch(this._2d){case"auto":(this._r.length>1&&1===this._s.length||this._r.length<this._s.length)&&this._1B();break;case"rows":this._1B()}},_1B:function(){var t,i=this._1;this._1=[],Bluff.each(i,function(t,i){Bluff.each(t.points,function(t,s){this.get_series(s).points[i]=t},this)},this),t=this._r,this._r=this._s,this._s=t,t=this._p,this._p=this._q,this._q=t},_1A:function(t){return t.replace(/<\/?[^>]+>/gi,"")},extend:{Mixin:new JS.Module({data_from_table:function(t,i){var s=new Bluff.TableReader(t,i),h=s.get_data();Bluff.each(h,function(t){this.data(t.name,t.points)},this),this.labels=s.get_labels(),this.title=s.get_title()||this.title}})}}),Bluff.Base.include(Bluff.TableReader.Mixin);