// Copyright 2006 Google Inc.
document.createElement("canvas").getContext||function(){function t(){return this.context_||(this.context_=new h(this))}function e(t,e){var i=k.call(arguments,2);return function(){return t.apply(e,i.concat(k.call(arguments)))}}function i(t){var e=t.srcElement;switch(t.propertyName){case"width":e.style.width=e.attributes.width.nodeValue+"px",e.getContext().clearRect();break;case"height":e.style.height=e.attributes.height.nodeValue+"px",e.getContext().clearRect()}}function n(t){var e=t.srcElement;e.firstChild&&(e.firstChild.style.width=e.clientWidth+"px",e.firstChild.style.height=e.clientHeight+"px")}function s(){return[[1,0,0],[0,1,0],[0,0,1]]}function o(t,e){for(var i=s(),n=0;3>n;n++)for(var o=0;3>o;o++){for(var a=0,r=0;3>r;r++)a+=t[n][r]*e[r][o];i[n][o]=a}return i}function a(t,e){e.fillStyle=t.fillStyle,e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.shadowBlur=t.shadowBlur,e.shadowColor=t.shadowColor,e.shadowOffsetX=t.shadowOffsetX,e.shadowOffsetY=t.shadowOffsetY,e.strokeStyle=t.strokeStyle,e.globalAlpha=t.globalAlpha,e.arcScaleX_=t.arcScaleX_,e.arcScaleY_=t.arcScaleY_,e.lineScale_=t.lineScale_}function r(t){var e,i=1;if(t=String(t),"rgb"==t.substring(0,3)){var n=t.indexOf("(",3),s=t.indexOf(")",n+1),o=t.substring(n+1,s).split(",");e="#";for(var a=0;3>a;a++)e+=E[Number(o[a])];4==o.length&&"a"==t.substr(3,1)&&(i=o[3])}else e=t;return{color:e,alpha:i}}function l(t){switch(t){case"butt":return"flat";case"round":return"round";case"square":default:return"square"}}function h(t){this.m_=s(),this.mStack_=[],this.aStack_=[],this.currentPath_=[],this.fillStyle=this.strokeStyle="#000",this.lineWidth=1,this.lineJoin="miter",this.lineCap="butt",this.miterLimit=1*x,this.globalAlpha=1,this.canvas=t;var e=t.ownerDocument.createElement("div");e.style.width=t.clientWidth+"px",e.style.height=t.clientHeight+"px",e.style.overflow="hidden",e.style.position="absolute",t.appendChild(e),this.element_=e,this.lineScale_=this.arcScaleY_=this.arcScaleX_=1}function u(t,e,i,n){t.currentPath_.push({type:"bezierCurveTo",cp1x:e.x,cp1y:e.y,cp2x:i.x,cp2y:i.y,x:n.x,y:n.y}),t.currentX_=n.x,t.currentY_=n.y}function c(t){for(var e=0;3>e;e++)for(var i=0;2>i;i++)if(!isFinite(t[e][i])||isNaN(t[e][i]))return!1;return!0}function d(t,e,i){c(e)&&(t.m_=e,i&&(t.lineScale_=y(b(e[0][0]*e[1][1]-e[0][1]*e[1][0]))))}function f(t){this.type_=t,this.r1_=this.y1_=this.x1_=this.r0_=this.y0_=this.x0_=0,this.colors_=[]}function p(){}var _=Math,m=_.round,g=_.sin,v=_.cos,b=_.abs,y=_.sqrt,x=10,w=x/2,k=Array.prototype.slice,T={init:function(t){if(/MSIE/.test(navigator.userAgent)&&!window.opera){var i=t||document;i.createElement("canvas"),i.attachEvent("onreadystatechange",e(this.init_,this,i))}},init_:function(t){if(t.namespaces.g_vml_||t.namespaces.add("g_vml_","urn:schemas-microsoft-com:vml","#default#VML"),t.namespaces.g_o_||t.namespaces.add("g_o_","urn:schemas-microsoft-com:office:office","#default#VML"),!t.styleSheets.ex_canvas_){var e=t.createStyleSheet();e.owningElement.id="ex_canvas_",e.cssText="canvas{display:inline-block;overflow:hidden;text-align:left;width:300px;height:150px}g_vml_\\:*{behavior:url(#default#VML)}g_o_\\:*{behavior:url(#default#VML)}"}for(var i=t.getElementsByTagName("canvas"),n=0;n<i.length;n++)this.initElement(i[n])},initElement:function(e){if(!e.getContext){e.getContext=t,e.innerHTML="",e.attachEvent("onpropertychange",i),e.attachEvent("onresize",n);var s=e.attributes;s.width&&s.width.specified?e.style.width=s.width.nodeValue+"px":e.width=e.clientWidth,s.height&&s.height.specified?e.style.height=s.height.nodeValue+"px":e.height=e.clientHeight}return e}};T.init();for(var E=[],C=0;16>C;C++)for(var S=0;16>S;S++)E[16*C+S]=C.toString(16)+S.toString(16);var A=h.prototype;A.clearRect=function(){this.element_.innerHTML=""},A.beginPath=function(){this.currentPath_=[]},A.moveTo=function(t,e){var i=this.getCoords_(t,e);this.currentPath_.push({type:"moveTo",x:i.x,y:i.y}),this.currentX_=i.x,this.currentY_=i.y},A.lineTo=function(t,e){var i=this.getCoords_(t,e);this.currentPath_.push({type:"lineTo",x:i.x,y:i.y}),this.currentX_=i.x,this.currentY_=i.y},A.bezierCurveTo=function(t,e,i,n,s,o){var a=this.getCoords_(s,o),r=this.getCoords_(t,e),l=this.getCoords_(i,n);u(this,r,l,a)},A.quadraticCurveTo=function(t,e,i,n){var s=this.getCoords_(t,e),o=this.getCoords_(i,n),a={x:this.currentX_+.6666666666666666*(s.x-this.currentX_),y:this.currentY_+.6666666666666666*(s.y-this.currentY_)};u(this,a,{x:a.x+(o.x-this.currentX_)/3,y:a.y+(o.y-this.currentY_)/3},o)},A.arc=function(t,e,i,n,s,o){i*=x;var a=o?"at":"wa",r=t+v(n)*i-w,l=e+g(n)*i-w,h=t+v(s)*i-w,u=e+g(s)*i-w;r!=h||o||(r+=.125);var c=this.getCoords_(t,e),d=this.getCoords_(r,l),f=this.getCoords_(h,u);this.currentPath_.push({type:a,x:c.x,y:c.y,radius:i,xStart:d.x,yStart:d.y,xEnd:f.x,yEnd:f.y})},A.rect=function(t,e,i,n){this.moveTo(t,e),this.lineTo(t+i,e),this.lineTo(t+i,e+n),this.lineTo(t,e+n),this.closePath()},A.strokeRect=function(t,e,i,n){var s=this.currentPath_;this.beginPath(),this.moveTo(t,e),this.lineTo(t+i,e),this.lineTo(t+i,e+n),this.lineTo(t,e+n),this.closePath(),this.stroke(),this.currentPath_=s},A.fillRect=function(t,e,i,n){var s=this.currentPath_;this.beginPath(),this.moveTo(t,e),this.lineTo(t+i,e),this.lineTo(t+i,e+n),this.lineTo(t,e+n),this.closePath(),this.fill(),this.currentPath_=s},A.createLinearGradient=function(t,e,i,n){var s=new f("gradient");return s.x0_=t,s.y0_=e,s.x1_=i,s.y1_=n,s},A.createRadialGradient=function(t,e,i,n,s,o){var a=new f("gradientradial");return a.x0_=t,a.y0_=e,a.r0_=i,a.x1_=n,a.y1_=s,a.r1_=o,a},A.drawImage=function(t){var e,i,n,s,o,a,r,l,h=t.runtimeStyle.width,u=t.runtimeStyle.height;t.runtimeStyle.width="auto",t.runtimeStyle.height="auto";var c=t.width,d=t.height;if(t.runtimeStyle.width=h,t.runtimeStyle.height=u,3==arguments.length)e=arguments[1],i=arguments[2],o=a=0,r=n=c,l=s=d;else if(5==arguments.length)e=arguments[1],i=arguments[2],n=arguments[3],s=arguments[4],o=a=0,r=c,l=d;else{if(9!=arguments.length)throw Error("Invalid number of arguments");o=arguments[1],a=arguments[2],r=arguments[3],l=arguments[4],e=arguments[5],i=arguments[6],n=arguments[7],s=arguments[8]}var f=this.getCoords_(e,i),p=[];if(p.push(" <g_vml_:group",' coordsize="',10*x,",",10*x,'"',' coordorigin="0,0"',' style="width:',10,"px;height:",10,"px;position:absolute;"),1!=this.m_[0][0]||this.m_[0][1]){var g=[];g.push("M11=",this.m_[0][0],",","M12=",this.m_[1][0],",","M21=",this.m_[0][1],",","M22=",this.m_[1][1],",","Dx=",m(f.x/x),",","Dy=",m(f.y/x),"");var v=f,b=this.getCoords_(e+n,i),y=this.getCoords_(e,i+s),w=this.getCoords_(e+n,i+s);v.x=_.max(v.x,b.x,y.x,w.x),v.y=_.max(v.y,b.y,y.y,w.y),p.push("padding:0 ",m(v.x/x),"px ",m(v.y/x),"px 0;filter:progid:DXImageTransform.Microsoft.Matrix(",g.join(""),", sizingmethod='clip');")}else p.push("top:",m(f.y/x),"px;left:",m(f.x/x),"px;");p.push(' ">','<g_vml_:image src="',t.src,'"',' style="width:',x*n,"px;"," height:",x*s,'px;"',' cropleft="',o/c,'"',' croptop="',a/d,'"',' cropright="',(c-o-r)/c,'"',' cropbottom="',(d-a-l)/d,'"'," />","</g_vml_:group>"),this.element_.insertAdjacentHTML("BeforeEnd",p.join(""))},A.stroke=function(t){var e=[],i=r(t?this.fillStyle:this.strokeStyle),n=i.color,s=i.alpha*this.globalAlpha;e.push("<g_vml_:shape",' filled="',!!t,'"',' style="position:absolute;width:',10,"px;height:",10,'px;"',' coordorigin="0 0" coordsize="',10*x," ",10*x,'"',' stroked="',!t,'"',' path="');for(var o={x:null,y:null},a={x:null,y:null},h=0;h<this.currentPath_.length;h++){var u=this.currentPath_[h];switch(u.type){case"moveTo":e.push(" m ",m(u.x),",",m(u.y));break;case"lineTo":e.push(" l ",m(u.x),",",m(u.y));break;case"close":e.push(" x "),u=null;break;case"bezierCurveTo":e.push(" c ",m(u.cp1x),",",m(u.cp1y),",",m(u.cp2x),",",m(u.cp2y),",",m(u.x),",",m(u.y));break;case"at":case"wa":e.push(" ",u.type," ",m(u.x-this.arcScaleX_*u.radius),",",m(u.y-this.arcScaleY_*u.radius)," ",m(u.x+this.arcScaleX_*u.radius),",",m(u.y+this.arcScaleY_*u.radius)," ",m(u.xStart),",",m(u.yStart)," ",m(u.xEnd),",",m(u.yEnd))}u&&((null==o.x||u.x<o.x)&&(o.x=u.x),(null==a.x||u.x>a.x)&&(a.x=u.x),(null==o.y||u.y<o.y)&&(o.y=u.y),(null==a.y||u.y>a.y)&&(a.y=u.y))}if(e.push(' ">'),t)if("object"==typeof this.fillStyle){var c=this.fillStyle,d=0,f={x:0,y:0},p=0,g=1;if("gradient"==c.type_){var v=c.x1_/this.arcScaleX_,b=c.y1_/this.arcScaleY_,y=this.getCoords_(c.x0_/this.arcScaleX_,c.y0_/this.arcScaleY_),w=this.getCoords_(v,b);d=180*Math.atan2(w.x-y.x,w.y-y.y)/Math.PI,0>d&&(d+=360),1e-6>d&&(d=0)}else{var y=this.getCoords_(c.x0_,c.y0_),k=a.x-o.x,T=a.y-o.y;f={x:(y.x-o.x)/k,y:(y.y-o.y)/T},k/=this.arcScaleX_*x,T/=this.arcScaleY_*x;var E=_.max(k,T);p=2*c.r0_/E,g=2*c.r1_/E-p}var C=c.colors_;C.sort(function(t,e){return t.offset-e.offset});for(var S=C.length,A=C[0].color,D=C[S-1].color,N=C[0].alpha*this.globalAlpha,z=C[S-1].alpha*this.globalAlpha,L=[],h=0;S>h;h++){var P=C[h];L.push(P.offset*g+p+" "+P.color)}e.push('<g_vml_:fill type="',c.type_,'"',' method="none" focus="100%"',' color="',A,'"',' color2="',D,'"',' colors="',L.join(","),'"',' opacity="',z,'"',' g_o_:opacity2="',N,'"',' angle="',d,'"',' focusposition="',f.x,",",f.y,'" />')}else e.push('<g_vml_:fill color="',n,'" opacity="',s,'" />');else{var B=this.lineScale_*this.lineWidth;1>B&&(s*=B),e.push("<g_vml_:stroke",' opacity="',s,'"',' joinstyle="',this.lineJoin,'"',' miterlimit="',this.miterLimit,'"',' endcap="',l(this.lineCap),'"',' weight="',B,'px"',' color="',n,'" />')}e.push("</g_vml_:shape>"),this.element_.insertAdjacentHTML("beforeEnd",e.join(""))},A.fill=function(){this.stroke(!0)},A.closePath=function(){this.currentPath_.push({type:"close"})},A.getCoords_=function(t,e){var i=this.m_;return{x:x*(t*i[0][0]+e*i[1][0]+i[2][0])-w,y:x*(t*i[0][1]+e*i[1][1]+i[2][1])-w}},A.save=function(){var t={};a(this,t),this.aStack_.push(t),this.mStack_.push(this.m_),this.m_=o(s(),this.m_)},A.restore=function(){a(this.aStack_.pop(),this),this.m_=this.mStack_.pop()},A.translate=function(t,e){d(this,o([[1,0,0],[0,1,0],[t,e,1]],this.m_),!1)},A.rotate=function(t){var e=v(t),i=g(t);d(this,o([[e,i,0],[-i,e,0],[0,0,1]],this.m_),!1)},A.scale=function(t,e){this.arcScaleX_*=t,this.arcScaleY_*=e,d(this,o([[t,0,0],[0,e,0],[0,0,1]],this.m_),!0)},A.transform=function(t,e,i,n,s,a){d(this,o([[t,e,0],[i,n,0],[s,a,1]],this.m_),!0)},A.setTransform=function(t,e,i,n,s,o){d(this,[[t,e,0],[i,n,0],[s,o,1]],!0)},A.clip=function(){},A.arcTo=function(){},A.createPattern=function(){return new p},f.prototype.addColorStop=function(t,e){e=r(e),this.colors_.push({offset:t,color:e.color,alpha:e.alpha})},G_vmlCanvasManager=T,CanvasRenderingContext2D=h,CanvasGradient=f,CanvasPattern=p}();